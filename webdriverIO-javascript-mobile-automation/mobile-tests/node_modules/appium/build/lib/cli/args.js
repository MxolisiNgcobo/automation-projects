"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getExtensionArgs = void 0;
exports.getServerArgs = getServerArgs;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _constants = require("../constants");

var _extensionConfig = require("../extension/extension-config");

var _cliArgs = require("../schema/cli-args");

const DRIVER_EXAMPLE = 'xcuitest';
const PLUGIN_EXAMPLE = 'find_by_image';
const INSTALL_TYPES_ARRAY = [..._extensionConfig.INSTALL_TYPES];
const EXTENSION_TYPES = new Set([_constants.DRIVER_TYPE, _constants.PLUGIN_TYPE]);
const globalExtensionArgs = new Map([[['--json'], {
  required: false,
  default: false,
  action: 'store_true',
  help: 'Use JSON for output format',
  dest: 'json'
}]]);

const getExtensionArgs = _lodash.default.memoize(function getExtensionArgs() {
  const extensionArgs = {};

  for (const type of EXTENSION_TYPES) {
    extensionArgs[type] = {
      [_constants.EXT_SUBCOMMAND_LIST]: makeListArgs(type),
      [_constants.EXT_SUBCOMMAND_INSTALL]: makeInstallArgs(type),
      [_constants.EXT_SUBCOMMAND_UNINSTALL]: makeUninstallArgs(type),
      [_constants.EXT_SUBCOMMAND_UPDATE]: makeUpdateArgs(type),
      [_constants.EXT_SUBCOMMAND_RUN]: makeRunArgs(type)
    };
  }

  return extensionArgs;
});

exports.getExtensionArgs = getExtensionArgs;

function makeListArgs(type) {
  return new Map([...globalExtensionArgs, [['--installed'], {
    required: false,
    default: false,
    action: 'store_true',
    help: `List only installed ${type}s`,
    dest: 'showInstalled'
  }], [['--updates'], {
    required: false,
    default: false,
    action: 'store_true',
    help: 'Show information about newer versions',
    dest: 'showUpdates'
  }]]);
}

function makeInstallArgs(type) {
  return new Map([...globalExtensionArgs, [[type], {
    type: 'str',
    help: `Name of the ${type} to install, for example: ` + type === _constants.DRIVER_TYPE ? DRIVER_EXAMPLE : PLUGIN_EXAMPLE
  }], [['--source'], {
    required: false,
    default: null,
    choices: INSTALL_TYPES_ARRAY,
    help: `Where to look for the ${type} if it is not one of Appium's verified ` + `${type}s. Possible values: ${INSTALL_TYPES_ARRAY.join(', ')}`,
    dest: 'installType'
  }], [['--package'], {
    required: false,
    default: null,
    type: 'str',
    help: `If installing from Git or GitHub, the package name, as defined in the plugin's ` + `package.json file in the "name" field, cannot be determined automatically, and ` + `should be reported here, otherwise the install will probably fail.`,
    dest: 'packageName'
  }]]);
}

function makeUninstallArgs(type) {
  return new Map([...globalExtensionArgs, [[type], {
    type: 'str',
    help: 'Name of the driver to uninstall, for example: ' + type === _constants.DRIVER_TYPE ? DRIVER_EXAMPLE : PLUGIN_EXAMPLE
  }]]);
}

function makeUpdateArgs(type) {
  return new Map([...globalExtensionArgs, [[type], {
    type: 'str',
    help: `Name of the ${type} to update, or the word "installed" to update all installed ` + `${type}s. To see available updates, run "appium ${type} list --installed --updates". ` + 'For example: ' + type === _constants.DRIVER_TYPE ? DRIVER_EXAMPLE : PLUGIN_EXAMPLE
  }], [['--unsafe'], {
    required: false,
    default: false,
    action: 'store_true',
    help: `Include updates that might have a new major revision, and potentially include ` + `breaking changes`
  }]]);
}

function makeRunArgs(type) {
  return new Map([...globalExtensionArgs, [[type], {
    type: 'str',
    help: `Name of the ${type} to run a script from, for example: ` + type === _constants.DRIVER_TYPE ? DRIVER_EXAMPLE : PLUGIN_EXAMPLE
  }], [['scriptName'], {
    default: null,
    type: 'str',
    help: `Name of the script to run from the ${type}. The script name must be cached ` + `inside the "scripts" field under "appium" inside the ${type}'s "package.json" file`
  }]]);
}

function getServerArgs() {
  return new Map([...(0, _cliArgs.toParserArgs)(), ...serverArgsDisallowedInConfig]);
}

const serverArgsDisallowedInConfig = new Map([[['--shell'], {
  required: false,
  help: 'Enter REPL mode',
  action: 'store_const',
  const: true,
  dest: 'shell'
}], [['--show-build-info'], {
  dest: 'showBuildInfo',
  action: 'store_const',
  const: true,
  required: false,
  help: 'Show info about the Appium build and exit'
}], [['--show-config'], {
  dest: 'showConfig',
  action: 'store_const',
  const: true,
  required: false,
  help: 'Show the current Appium configuration and exit'
}], [['--config'], {
  dest: 'configFile',
  type: 'string',
  required: false,
  help: 'Explicit path to Appium configuration file'
}]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEUklWRVJfRVhBTVBMRSIsIlBMVUdJTl9FWEFNUExFIiwiSU5TVEFMTF9UWVBFU19BUlJBWSIsIklOU1RBTExfVFlQRVMiLCJFWFRFTlNJT05fVFlQRVMiLCJTZXQiLCJEUklWRVJfVFlQRSIsIlBMVUdJTl9UWVBFIiwiZ2xvYmFsRXh0ZW5zaW9uQXJncyIsIk1hcCIsInJlcXVpcmVkIiwiZGVmYXVsdCIsImFjdGlvbiIsImhlbHAiLCJkZXN0IiwiZ2V0RXh0ZW5zaW9uQXJncyIsIl8iLCJtZW1vaXplIiwiZXh0ZW5zaW9uQXJncyIsInR5cGUiLCJFWFRfU1VCQ09NTUFORF9MSVNUIiwibWFrZUxpc3RBcmdzIiwiRVhUX1NVQkNPTU1BTkRfSU5TVEFMTCIsIm1ha2VJbnN0YWxsQXJncyIsIkVYVF9TVUJDT01NQU5EX1VOSU5TVEFMTCIsIm1ha2VVbmluc3RhbGxBcmdzIiwiRVhUX1NVQkNPTU1BTkRfVVBEQVRFIiwibWFrZVVwZGF0ZUFyZ3MiLCJFWFRfU1VCQ09NTUFORF9SVU4iLCJtYWtlUnVuQXJncyIsImNob2ljZXMiLCJqb2luIiwiZ2V0U2VydmVyQXJncyIsInRvUGFyc2VyQXJncyIsInNlcnZlckFyZ3NEaXNhbGxvd2VkSW5Db25maWciLCJjb25zdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9jbGkvYXJncy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtaWdub3JlXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHtcbiAgRFJJVkVSX1RZUEUsXG4gIFBMVUdJTl9UWVBFLFxuICBFWFRfU1VCQ09NTUFORF9JTlNUQUxMLFxuICBFWFRfU1VCQ09NTUFORF9MSVNULFxuICBFWFRfU1VCQ09NTUFORF9SVU4sXG4gIEVYVF9TVUJDT01NQU5EX1VOSU5TVEFMTCxcbiAgRVhUX1NVQkNPTU1BTkRfVVBEQVRFLFxufSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtJTlNUQUxMX1RZUEVTfSBmcm9tICcuLi9leHRlbnNpb24vZXh0ZW5zaW9uLWNvbmZpZyc7XG5pbXBvcnQge3RvUGFyc2VyQXJnc30gZnJvbSAnLi4vc2NoZW1hL2NsaS1hcmdzJztcbmNvbnN0IERSSVZFUl9FWEFNUExFID0gJ3hjdWl0ZXN0JztcbmNvbnN0IFBMVUdJTl9FWEFNUExFID0gJ2ZpbmRfYnlfaW1hZ2UnO1xuXG4vKipcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugd2UgcGFzcyB0aGUgYXJyYXkgaW50byBgYXJncGFyc2VgLiBgYXJncGFyc2VgIGlzIGJhZCBhbmQgbXV0YXRlcyB0aGluZ3MuIFdlIGRvbid0IHdhbnQgdGhhdC5cbiAqIEJhZCBgYXJncGFyc2VgISBCYWQhXG4gKi9cbmNvbnN0IElOU1RBTExfVFlQRVNfQVJSQVkgPSBbLi4uSU5TVEFMTF9UWVBFU107XG5cbi8qKiBAdHlwZSB7U2V0PEV4dGVuc2lvblR5cGU+fSAqL1xuY29uc3QgRVhURU5TSU9OX1RZUEVTID0gbmV3IFNldChbRFJJVkVSX1RZUEUsIFBMVUdJTl9UWVBFXSk7XG5cbi8vIHRoaXMgc2V0IG9mIGFyZ3Mgd29ya3MgZm9yIGJvdGggZHJpdmVycyBhbmQgcGx1Z2lucyAoJ2V4dGVuc2lvbnMnKVxuLyoqIEB0eXBlIHtBcmd1bWVudERlZmluaXRpb25zfSAqL1xuY29uc3QgZ2xvYmFsRXh0ZW5zaW9uQXJncyA9IG5ldyBNYXAoW1xuICBbXG4gICAgWyctLWpzb24nXSxcbiAgICB7XG4gICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICAgIGFjdGlvbjogJ3N0b3JlX3RydWUnLFxuICAgICAgaGVscDogJ1VzZSBKU09OIGZvciBvdXRwdXQgZm9ybWF0JyxcbiAgICAgIGRlc3Q6ICdqc29uJyxcbiAgICB9LFxuICBdLFxuXSk7XG5cbi8qKlxuICogQnVpbGRzIGEgUmVjb3JkIG9mIGV4dGVuc2lvbiB0eXBlcyB0byBhIFJlY29yZCBvZiBzdWJjb21tYW5kcyB0byB0aGVpciBhcmd1bWVudCBkZWZpbml0aW9uc1xuICovXG5jb25zdCBnZXRFeHRlbnNpb25BcmdzID0gXy5tZW1vaXplKGZ1bmN0aW9uIGdldEV4dGVuc2lvbkFyZ3MoKSB7XG4gIGNvbnN0IGV4dGVuc2lvbkFyZ3MgPSB7fTtcbiAgZm9yIChjb25zdCB0eXBlIG9mIEVYVEVOU0lPTl9UWVBFUykge1xuICAgIGV4dGVuc2lvbkFyZ3NbdHlwZV0gPSB7XG4gICAgICBbRVhUX1NVQkNPTU1BTkRfTElTVF06IG1ha2VMaXN0QXJncyh0eXBlKSxcbiAgICAgIFtFWFRfU1VCQ09NTUFORF9JTlNUQUxMXTogbWFrZUluc3RhbGxBcmdzKHR5cGUpLFxuICAgICAgW0VYVF9TVUJDT01NQU5EX1VOSU5TVEFMTF06IG1ha2VVbmluc3RhbGxBcmdzKHR5cGUpLFxuICAgICAgW0VYVF9TVUJDT01NQU5EX1VQREFURV06IG1ha2VVcGRhdGVBcmdzKHR5cGUpLFxuICAgICAgW0VYVF9TVUJDT01NQU5EX1JVTl06IG1ha2VSdW5BcmdzKHR5cGUpLFxuICAgIH07XG4gIH1cbiAgcmV0dXJuIC8qKiBAdHlwZSB7UmVjb3JkPEV4dGVuc2lvblR5cGUsIFJlY29yZDxpbXBvcnQoJ2FwcGl1bS90eXBlcycpLkNsaUV4dGVuc2lvblN1YmNvbW1hbmQsQXJndW1lbnREZWZpbml0aW9ucz4+fSAqLyAoXG4gICAgZXh0ZW5zaW9uQXJnc1xuICApO1xufSk7XG5cbi8qKlxuICogTWFrZXMgdGhlIG9wdHMgZm9yIHRoZSBgbGlzdGAgc3ViY29tbWFuZCBmb3IgZWFjaCBleHRlbnNpb24gdHlwZS5cbiAqIEBwYXJhbSB7RXh0ZW5zaW9uVHlwZX0gdHlwZVxuICogQHJldHVybnMge0FyZ3VtZW50RGVmaW5pdGlvbnN9XG4gKi9cbmZ1bmN0aW9uIG1ha2VMaXN0QXJncyh0eXBlKSB7XG4gIHJldHVybiBuZXcgTWFwKFtcbiAgICAuLi5nbG9iYWxFeHRlbnNpb25BcmdzLFxuICAgIFtcbiAgICAgIFsnLS1pbnN0YWxsZWQnXSxcbiAgICAgIHtcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICAgICAgYWN0aW9uOiAnc3RvcmVfdHJ1ZScsXG4gICAgICAgIGhlbHA6IGBMaXN0IG9ubHkgaW5zdGFsbGVkICR7dHlwZX1zYCxcbiAgICAgICAgZGVzdDogJ3Nob3dJbnN0YWxsZWQnLFxuICAgICAgfSxcbiAgICBdLFxuICAgIFtcbiAgICAgIFsnLS11cGRhdGVzJ10sXG4gICAgICB7XG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgIGFjdGlvbjogJ3N0b3JlX3RydWUnLFxuICAgICAgICBoZWxwOiAnU2hvdyBpbmZvcm1hdGlvbiBhYm91dCBuZXdlciB2ZXJzaW9ucycsXG4gICAgICAgIGRlc3Q6ICdzaG93VXBkYXRlcycsXG4gICAgICB9LFxuICAgIF0sXG4gIF0pO1xufVxuXG4vKipcbiAqIE1ha2VzIHRoZSBvcHRzIGZvciB0aGUgYGluc3RhbGxgIHN1YmNvbW1hbmQgZm9yIGVhY2ggZXh0ZW5zaW9uIHR5cGVcbiAqIEBwYXJhbSB7RXh0ZW5zaW9uVHlwZX0gdHlwZVxuICogQHJldHVybnMge0FyZ3VtZW50RGVmaW5pdGlvbnN9XG4gKi9cbmZ1bmN0aW9uIG1ha2VJbnN0YWxsQXJncyh0eXBlKSB7XG4gIHJldHVybiBuZXcgTWFwKFtcbiAgICAuLi5nbG9iYWxFeHRlbnNpb25BcmdzLFxuICAgIFtcbiAgICAgIFt0eXBlXSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ3N0cicsXG4gICAgICAgIGhlbHA6XG4gICAgICAgICAgYE5hbWUgb2YgdGhlICR7dHlwZX0gdG8gaW5zdGFsbCwgZm9yIGV4YW1wbGU6IGAgKyB0eXBlID09PSBEUklWRVJfVFlQRVxuICAgICAgICAgICAgPyBEUklWRVJfRVhBTVBMRVxuICAgICAgICAgICAgOiBQTFVHSU5fRVhBTVBMRSxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBbXG4gICAgICBbJy0tc291cmNlJ10sXG4gICAgICB7XG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgY2hvaWNlczogSU5TVEFMTF9UWVBFU19BUlJBWSxcbiAgICAgICAgaGVscDpcbiAgICAgICAgICBgV2hlcmUgdG8gbG9vayBmb3IgdGhlICR7dHlwZX0gaWYgaXQgaXMgbm90IG9uZSBvZiBBcHBpdW0ncyB2ZXJpZmllZCBgICtcbiAgICAgICAgICBgJHt0eXBlfXMuIFBvc3NpYmxlIHZhbHVlczogJHtJTlNUQUxMX1RZUEVTX0FSUkFZLmpvaW4oJywgJyl9YCxcbiAgICAgICAgZGVzdDogJ2luc3RhbGxUeXBlJyxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBbXG4gICAgICBbJy0tcGFja2FnZSddLFxuICAgICAge1xuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIHR5cGU6ICdzdHInLFxuICAgICAgICBoZWxwOlxuICAgICAgICAgIGBJZiBpbnN0YWxsaW5nIGZyb20gR2l0IG9yIEdpdEh1YiwgdGhlIHBhY2thZ2UgbmFtZSwgYXMgZGVmaW5lZCBpbiB0aGUgcGx1Z2luJ3MgYCArXG4gICAgICAgICAgYHBhY2thZ2UuanNvbiBmaWxlIGluIHRoZSBcIm5hbWVcIiBmaWVsZCwgY2Fubm90IGJlIGRldGVybWluZWQgYXV0b21hdGljYWxseSwgYW5kIGAgK1xuICAgICAgICAgIGBzaG91bGQgYmUgcmVwb3J0ZWQgaGVyZSwgb3RoZXJ3aXNlIHRoZSBpbnN0YWxsIHdpbGwgcHJvYmFibHkgZmFpbC5gLFxuICAgICAgICBkZXN0OiAncGFja2FnZU5hbWUnLFxuICAgICAgfSxcbiAgICBdLFxuICBdKTtcbn1cblxuLyoqXG4gKiBNYWtlcyB0aGUgb3B0cyBmb3IgdGhlIGB1bmluc3RhbGxgIHN1YmNvbW1hbmQgZm9yIGVhY2ggZXh0ZW5zaW9uIHR5cGVcbiAqIEBwYXJhbSB7RXh0ZW5zaW9uVHlwZX0gdHlwZVxuICogQHJldHVybnMge0FyZ3VtZW50RGVmaW5pdGlvbnN9XG4gKi9cbmZ1bmN0aW9uIG1ha2VVbmluc3RhbGxBcmdzKHR5cGUpIHtcbiAgcmV0dXJuIG5ldyBNYXAoW1xuICAgIC4uLmdsb2JhbEV4dGVuc2lvbkFyZ3MsXG4gICAgW1xuICAgICAgW3R5cGVdLFxuICAgICAge1xuICAgICAgICB0eXBlOiAnc3RyJyxcbiAgICAgICAgaGVscDpcbiAgICAgICAgICAnTmFtZSBvZiB0aGUgZHJpdmVyIHRvIHVuaW5zdGFsbCwgZm9yIGV4YW1wbGU6ICcgKyB0eXBlID09PSBEUklWRVJfVFlQRVxuICAgICAgICAgICAgPyBEUklWRVJfRVhBTVBMRVxuICAgICAgICAgICAgOiBQTFVHSU5fRVhBTVBMRSxcbiAgICAgIH0sXG4gICAgXSxcbiAgXSk7XG59XG5cbi8qKlxuICogTWFrZXMgdGhlIG9wdHMgZm9yIHRoZSBgdXBkYXRlYCBzdWJjb21tYW5kIGZvciBlYWNoIGV4dGVuc2lvbiB0eXBlXG4gKiBAcGFyYW0ge0V4dGVuc2lvblR5cGV9IHR5cGVcbiAqIEByZXR1cm5zIHtBcmd1bWVudERlZmluaXRpb25zfVxuICovXG5mdW5jdGlvbiBtYWtlVXBkYXRlQXJncyh0eXBlKSB7XG4gIHJldHVybiBuZXcgTWFwKFtcbiAgICAuLi5nbG9iYWxFeHRlbnNpb25BcmdzLFxuICAgIFtcbiAgICAgIFt0eXBlXSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ3N0cicsXG4gICAgICAgIGhlbHA6XG4gICAgICAgICAgYE5hbWUgb2YgdGhlICR7dHlwZX0gdG8gdXBkYXRlLCBvciB0aGUgd29yZCBcImluc3RhbGxlZFwiIHRvIHVwZGF0ZSBhbGwgaW5zdGFsbGVkIGAgK1xuICAgICAgICAgICAgYCR7dHlwZX1zLiBUbyBzZWUgYXZhaWxhYmxlIHVwZGF0ZXMsIHJ1biBcImFwcGl1bSAke3R5cGV9IGxpc3QgLS1pbnN0YWxsZWQgLS11cGRhdGVzXCIuIGAgK1xuICAgICAgICAgICAgJ0ZvciBleGFtcGxlOiAnICtcbiAgICAgICAgICAgIHR5cGUgPT09XG4gICAgICAgICAgRFJJVkVSX1RZUEVcbiAgICAgICAgICAgID8gRFJJVkVSX0VYQU1QTEVcbiAgICAgICAgICAgIDogUExVR0lOX0VYQU1QTEUsXG4gICAgICB9LFxuICAgIF0sXG4gICAgW1xuICAgICAgWyctLXVuc2FmZSddLFxuICAgICAge1xuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgICAgICBhY3Rpb246ICdzdG9yZV90cnVlJyxcbiAgICAgICAgaGVscDpcbiAgICAgICAgICBgSW5jbHVkZSB1cGRhdGVzIHRoYXQgbWlnaHQgaGF2ZSBhIG5ldyBtYWpvciByZXZpc2lvbiwgYW5kIHBvdGVudGlhbGx5IGluY2x1ZGUgYCArXG4gICAgICAgICAgYGJyZWFraW5nIGNoYW5nZXNgLFxuICAgICAgfSxcbiAgICBdLFxuICBdKTtcbn1cblxuLyoqXG4gKiBNYWtlcyB0aGUgb3B0cyBmb3IgdGhlIGBydW5gIHN1YmNvbW1hbmQgZm9yIGVhY2ggZXh0ZW5zaW9uIHR5cGVcbiAqIEBwYXJhbSB7RXh0ZW5zaW9uVHlwZX0gdHlwZVxuICogQHJldHVybnMge0FyZ3VtZW50RGVmaW5pdGlvbnN9XG4gKi9cbmZ1bmN0aW9uIG1ha2VSdW5BcmdzKHR5cGUpIHtcbiAgcmV0dXJuIG5ldyBNYXAoW1xuICAgIC4uLmdsb2JhbEV4dGVuc2lvbkFyZ3MsXG4gICAgW1xuICAgICAgW3R5cGVdLFxuICAgICAge1xuICAgICAgICB0eXBlOiAnc3RyJyxcbiAgICAgICAgaGVscDpcbiAgICAgICAgICBgTmFtZSBvZiB0aGUgJHt0eXBlfSB0byBydW4gYSBzY3JpcHQgZnJvbSwgZm9yIGV4YW1wbGU6IGAgKyB0eXBlID09PSBEUklWRVJfVFlQRVxuICAgICAgICAgICAgPyBEUklWRVJfRVhBTVBMRVxuICAgICAgICAgICAgOiBQTFVHSU5fRVhBTVBMRSxcbiAgICAgIH0sXG4gICAgXSxcbiAgICBbXG4gICAgICBbJ3NjcmlwdE5hbWUnXSxcbiAgICAgIHtcbiAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgdHlwZTogJ3N0cicsXG4gICAgICAgIGhlbHA6XG4gICAgICAgICAgYE5hbWUgb2YgdGhlIHNjcmlwdCB0byBydW4gZnJvbSB0aGUgJHt0eXBlfS4gVGhlIHNjcmlwdCBuYW1lIG11c3QgYmUgY2FjaGVkIGAgK1xuICAgICAgICAgIGBpbnNpZGUgdGhlIFwic2NyaXB0c1wiIGZpZWxkIHVuZGVyIFwiYXBwaXVtXCIgaW5zaWRlIHRoZSAke3R5cGV9J3MgXCJwYWNrYWdlLmpzb25cIiBmaWxlYCxcbiAgICAgIH0sXG4gICAgXSxcbiAgXSk7XG59XG5cbi8qKlxuICogRGVyaXZlcyB0aGUgb3B0aW9ucyBmb3IgdGhlIGBzZXJ2ZXJgIGNvbW1hbmQgZnJvbSB0aGUgc2NoZW1hLCBhbmQgYWRkcyB0aGUgYXJndW1lbnRzXG4gKiB3aGljaCBhcmUgZGlzYWxsb3dlZCBpbiB0aGUgY29uZmlnIGZpbGUuXG4gKiBAcmV0dXJucyB7QXJndW1lbnREZWZpbml0aW9uc31cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmVyQXJncygpIHtcbiAgcmV0dXJuIG5ldyBNYXAoWy4uLnRvUGFyc2VyQXJncygpLCAuLi5zZXJ2ZXJBcmdzRGlzYWxsb3dlZEluQ29uZmlnXSk7XG59XG5cbi8qKlxuICogVGhlc2UgZG9uJ3QgbWFrZSBzZW5zZSBpbiB0aGUgY29udGV4dCBvZiBhIGNvbmZpZyBmaWxlIGZvciBvYnZpb3VzIHJlYXNvbnMuXG4gKiBAdHlwZSB7QXJndW1lbnREZWZpbml0aW9uc31cbiAqL1xuY29uc3Qgc2VydmVyQXJnc0Rpc2FsbG93ZWRJbkNvbmZpZyA9IG5ldyBNYXAoW1xuICBbXG4gICAgWyctLXNoZWxsJ10sXG4gICAge1xuICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgaGVscDogJ0VudGVyIFJFUEwgbW9kZScsXG4gICAgICBhY3Rpb246ICdzdG9yZV9jb25zdCcsXG4gICAgICBjb25zdDogdHJ1ZSxcbiAgICAgIGRlc3Q6ICdzaGVsbCcsXG4gICAgfSxcbiAgXSxcbiAgW1xuICAgIFsnLS1zaG93LWJ1aWxkLWluZm8nXSxcbiAgICB7XG4gICAgICBkZXN0OiAnc2hvd0J1aWxkSW5mbycsXG4gICAgICBhY3Rpb246ICdzdG9yZV9jb25zdCcsXG4gICAgICBjb25zdDogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgIGhlbHA6ICdTaG93IGluZm8gYWJvdXQgdGhlIEFwcGl1bSBidWlsZCBhbmQgZXhpdCcsXG4gICAgfSxcbiAgXSxcbiAgW1xuICAgIFsnLS1zaG93LWNvbmZpZyddLFxuICAgIHtcbiAgICAgIGRlc3Q6ICdzaG93Q29uZmlnJyxcbiAgICAgIGFjdGlvbjogJ3N0b3JlX2NvbnN0JyxcbiAgICAgIGNvbnN0OiB0cnVlLFxuICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgaGVscDogJ1Nob3cgdGhlIGN1cnJlbnQgQXBwaXVtIGNvbmZpZ3VyYXRpb24gYW5kIGV4aXQnLFxuICAgIH0sXG4gIF0sXG4gIFtcbiAgICBbJy0tY29uZmlnJ10sXG4gICAge1xuICAgICAgZGVzdDogJ2NvbmZpZ0ZpbGUnLFxuICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICBoZWxwOiAnRXhwbGljaXQgcGF0aCB0byBBcHBpdW0gY29uZmlndXJhdGlvbiBmaWxlJyxcbiAgICB9LFxuICBdLFxuXSk7XG5cbmV4cG9ydCB7Z2V0U2VydmVyQXJncywgZ2V0RXh0ZW5zaW9uQXJnc307XG5cbi8qKlxuICogQWxpYXNcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uL2V4dGVuc2lvbi9tYW5pZmVzdCcpLkV4dGVuc2lvblR5cGV9IEV4dGVuc2lvblR5cGVcbiAqL1xuXG4vKipcbiAqIEEgdHVwbGUgb2YgYXJndW1lbnQgYWxpYXNlcyBhbmQgYXJndW1lbnQgb3B0aW9uc1xuICogQHR5cGVkZWYge01hcDxzdHJpbmdbXSxpbXBvcnQoJ2FyZ3BhcnNlJykuQXJndW1lbnRPcHRpb25zPn0gQXJndW1lbnREZWZpbml0aW9uc1xuICovXG4iXSwibWFwcGlu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