"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.NoDriverProxyCommandError = exports.AppiumDriver = void 0;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _config = require("./config");

var _baseDriver = require("@appium/base-driver");

var _asyncLock = _interopRequireDefault(require("async-lock"));

var _utils = require("./utils");

var _support = require("@appium/support");

var _schema = require("./schema");

var _constants = require("./constants");

const desiredCapabilityConstraints = Object.freeze({
  automationName: {
    presence: true,
    isString: true
  },
  platformName: {
    presence: true,
    isString: true
  }
});
const sessionsListGuard = new _asyncLock.default();
const pendingDriversGuard = new _asyncLock.default();

class AppiumDriver extends _baseDriver.DriverCore {
  sessions = {};
  pendingDrivers = {};
  newCommandTimeoutMs = 0;
  pluginClasses;
  sessionPlugins = {};
  sessionlessPlugins = [];
  driverConfig;
  server;
  desiredCapConstraints = desiredCapabilityConstraints;
  args;

  constructor(opts) {
    if (opts.tmpDir) {
      process.env.APPIUM_TMP_DIR = opts.tmpDir;
    }

    super(opts);
    this.args = { ...opts
    };
    (0, _config.updateBuildInfo)().catch(err => {
      this.log.debug(err);
    });
  }

  get log() {
    if (!this._log) {
      const instanceName = `${this.constructor.name}@${_support.node.getObjectId(this).substring(0, 4)}`;
      this._log = _support.logger.getLogger(instanceName);
    }

    return this._log;
  }

  get isCommandsQueueEnabled() {
    return false;
  }

  sessionExists(sessionId) {
    const dstSession = this.sessions[sessionId];
    return dstSession && dstSession.sessionId !== null;
  }

  driverForSession(sessionId) {
    return this.sessions[sessionId];
  }

  async getStatus() {
    return {
      build: _lodash.default.clone((0, _config.getBuildInfo)())
    };
  }

  async getSessions() {
    return _lodash.default.toPairs(this.sessions).map(([id, driver]) => ({
      id,
      capabilities: driver.caps
    }));
  }

  printNewSessionAnnouncement(driverName, driverVersion, driverBaseVersion) {
    this.log.info(driverVersion ? `Appium v${_config.APPIUM_VER} creating new ${driverName} (v${driverVersion}) session` : `Appium v${_config.APPIUM_VER} creating new ${driverName} session`);
    this.log.info(`Checking BaseDriver versions for Appium and ${driverName}`);
    this.log.info(AppiumDriver.baseVersion ? `Appium's BaseDriver version is ${AppiumDriver.baseVersion}` : `Could not determine Appium's BaseDriver version`);
    this.log.info(driverBaseVersion ? `${driverName}'s BaseDriver version is ${driverBaseVersion}` : `Could not determine ${driverName}'s BaseDriver version`);
  }

  getCliArgsForPlugin(extName) {
    var _this$args$plugin$ext, _this$args$plugin;

    return (_this$args$plugin$ext = (_this$args$plugin = this.args.plugin) === null || _this$args$plugin === void 0 ? void 0 : _this$args$plugin[extName]) !== null && _this$args$plugin$ext !== void 0 ? _this$args$plugin$ext : {};
  }

  getCliArgsForDriver(extName) {
    var _this$args$driver;

    const allCliArgsForExt = (_this$args$driver = this.args.driver) === null || _this$args$driver === void 0 ? void 0 : _this$args$driver[extName];

    if (!_lodash.default.isEmpty(allCliArgsForExt)) {
      const defaults = (0, _schema.getDefaultsForExtension)(_constants.DRIVER_TYPE, extName);
      const cliArgs = _lodash.default.isEmpty(defaults) ? allCliArgsForExt : _lodash.default.omitBy(allCliArgsForExt, (value, key) => _lodash.default.isEqual(defaults[key], value));

      if (!_lodash.default.isEmpty(cliArgs)) {
        return cliArgs;
      }
    }
  }

  async createSession(jsonwpCaps, reqCaps, w3cCapabilities, driverData) {
    var _alwaysMatch, _w3cCapabilities;

    const defaultCapabilities = _lodash.default.cloneDeep(this.args.defaultCapabilities);

    const defaultSettings = (0, _utils.pullSettings)(defaultCapabilities);
    jsonwpCaps = _lodash.default.cloneDeep(jsonwpCaps);
    const jwpSettings = { ...defaultSettings,
      ...(0, _utils.pullSettings)(jsonwpCaps)
    };
    w3cCapabilities = _lodash.default.cloneDeep(w3cCapabilities);
    const w3cSettings = { ...jwpSettings,
      ...(0, _utils.pullSettings)((_alwaysMatch = ((_w3cCapabilities = w3cCapabilities) !== null && _w3cCapabilities !== void 0 ? _w3cCapabilities : {}).alwaysMatch) !== null && _alwaysMatch !== void 0 ? _alwaysMatch : {})
    };

    for (const firstMatchEntry of (_firstMatch = ((_w3cCapabilities2 = w3cCapabilities) !== null && _w3cCapabilities2 !== void 0 ? _w3cCapabilities2 : {}).firstMatch) !== null && _firstMatch !== void 0 ? _firstMatch : []) {
      var _firstMatch, _w3cCapabilities2;

      Object.assign(w3cSettings, (0, _utils.pullSettings)(firstMatchEntry));
    }

    let protocol;
    let innerSessionId, dCaps;

    try {
      const parsedCaps = (0, _utils.parseCapsForInnerDriver)(jsonwpCaps, w3cCapabilities, this.desiredCapConstraints, defaultCapabilities);
      const {
        desiredCaps,
        processedJsonwpCapabilities,
        processedW3CCapabilities
      } = parsedCaps;
      protocol = parsedCaps.protocol;
      const error = parsedCaps.error;

      if (error) {
        throw error;
      }

      const {
        driver: InnerDriver,
        version: driverVersion,
        driverName
      } = this.driverConfig.findMatchingDriver(desiredCaps);
      this.printNewSessionAnnouncement(InnerDriver.name, driverVersion, InnerDriver.baseVersion);

      if (this.args.sessionOverride) {
        await this.deleteAllSessions();
      }

      let runningDriversData = [];
      let otherPendingDriversData = [];
      const driverInstance = new InnerDriver(this.args, true);

      if (this.args.relaxedSecurityEnabled) {
        this.log.info(`Applying relaxed security to '${InnerDriver.name}' as per ` + `server command line argument. All insecure features will be ` + `enabled unless explicitly disabled by --deny-insecure`);
        driverInstance.relaxedSecurityEnabled = true;
      }

      if (!_lodash.default.isEmpty(this.args.denyInsecure)) {
        this.log.info('Explicitly preventing use of insecure features:');
        this.args.denyInsecure.map(a => this.log.info(`    ${a}`));
        driverInstance.denyInsecure = this.args.denyInsecure;
      }

      if (!_lodash.default.isEmpty(this.args.allowInsecure)) {
        this.log.info('Explicitly enabling use of insecure features:');
        this.args.allowInsecure.map(a => this.log.info(`    ${a}`));
        driverInstance.allowInsecure = this.args.allowInsecure;
      }

      const cliArgs = this.getCliArgsForDriver(driverName);

      if (!_lodash.default.isEmpty(cliArgs)) {
        driverInstance.cliArgs = cliArgs;
      }

      driverInstance.server = this.server;
      driverInstance.serverHost = this.args.address;
      driverInstance.serverPort = this.args.port;
      driverInstance.serverPath = this.args.basePath;

      try {
        var _await$this$curSessio;

        runningDriversData = (_await$this$curSessio = await this.curSessionDataForDriver(InnerDriver)) !== null && _await$this$curSessio !== void 0 ? _await$this$curSessio : [];
      } catch (e) {
        throw new _baseDriver.errors.SessionNotCreatedError(e.message);
      }

      await pendingDriversGuard.acquire(AppiumDriver.name, () => {
        this.pendingDrivers[InnerDriver.name] = this.pendingDrivers[InnerDriver.name] || [];
        otherPendingDriversData = _lodash.default.compact(this.pendingDrivers[InnerDriver.name].map(drv => drv.driverData));
        this.pendingDrivers[InnerDriver.name].push(driverInstance);
      });

      try {
        [innerSessionId, dCaps] = await driverInstance.createSession(processedJsonwpCapabilities, reqCaps, processedW3CCapabilities, [...runningDriversData, ...otherPendingDriversData]);
        protocol = driverInstance.protocol;
        this.sessions[innerSessionId] = driverInstance;
      } finally {
        await pendingDriversGuard.acquire(AppiumDriver.name, () => {
          _lodash.default.pull(this.pendingDrivers[InnerDriver.name], driverInstance);
        });
      }

      this.attachUnexpectedShutdownHandler(driverInstance, innerSessionId);
      this.log.info(`New ${InnerDriver.name} session created successfully, session ` + `${innerSessionId} added to master session list`);
      driverInstance.startNewCommandTimeout();

      if (driverInstance.isW3CProtocol() && !_lodash.default.isEmpty(w3cSettings)) {
        this.log.info(`Applying the initial values to Appium settings parsed from W3C caps: ` + JSON.stringify(w3cSettings));
        await driverInstance.updateSettings(w3cSettings);
      } else if (driverInstance.isMjsonwpProtocol() && !_lodash.default.isEmpty(jwpSettings)) {
        this.log.info(`Applying the initial values to Appium settings parsed from MJSONWP caps: ` + JSON.stringify(jwpSettings));
        await driverInstance.updateSettings(jwpSettings);
      }
    } catch (error) {
      return {
        protocol,
        error
      };
    }

    return {
      protocol,
      value: [innerSessionId, dCaps, protocol]
    };
  }

  attachUnexpectedShutdownHandler(driver, innerSessionId) {
    const onShutdown = (cause = new Error('Unknown error')) => {
      this.log.warn(`Ending session, cause was '${cause.message}'`);

      if (this.sessionPlugins[innerSessionId]) {
        for (const plugin of this.sessionPlugins[innerSessionId]) {
          if (_lodash.default.isFunction(plugin.onUnexpectedShutdown)) {
            this.log.debug(`Plugin ${plugin.name} defines an unexpected shutdown handler; calling it now`);

            try {
              plugin.onUnexpectedShutdown(driver, cause);
            } catch (e) {
              this.log.warn(`Got an error when running plugin ${plugin.name} shutdown handler: ${e}`);
            }
          } else {
            this.log.debug(`Plugin ${plugin.name} does not define an unexpected shutdown handler`);
          }
        }
      }

      this.log.info(`Removing session '${innerSessionId}' from our master session list`);
      delete this.sessions[innerSessionId];
      delete this.sessionPlugins[innerSessionId];
    };

    if (_lodash.default.isFunction(driver.onUnexpectedShutdown)) {
      driver.onUnexpectedShutdown(onShutdown);
    } else {
      this.log.warn(`Failed to attach the unexpected shutdown listener. ` + `Is 'onUnexpectedShutdown' method available for '${driver.constructor.name}'?`);
    }
  }

  async curSessionDataForDriver(InnerDriver) {
    const data = _lodash.default.compact(_lodash.default.values(this.sessions).filter(s => s.constructor.name === InnerDriver.name).map(s => s.driverData));

    for (const datum of data) {
      if (!datum) {
        throw new Error(`Problem getting session data for driver type ` + `${InnerDriver.name}; does it implement 'get driverData'?`);
      }
    }

    return data;
  }

  async deleteSession(sessionId) {
    let protocol;

    try {
      let otherSessionsData;
      const dstSession = await sessionsListGuard.acquire(AppiumDriver.name, () => {
        if (!this.sessions[sessionId]) {
          return;
        }

        const curConstructorName = this.sessions[sessionId].constructor.name;
        otherSessionsData = _lodash.default.toPairs(this.sessions).filter(([key, value]) => value.constructor.name === curConstructorName && key !== sessionId).map(([, value]) => value.driverData);
        const dstSession = this.sessions[sessionId];
        protocol = dstSession.protocol;
        this.log.info(`Removing session ${sessionId} from our master session list`);
        delete this.sessions[sessionId];
        delete this.sessionPlugins[sessionId];
        return dstSession;
      });

      if (!dstSession) {
        throw new Error('Session not found');
      }

      return {
        protocol,
        value: await dstSession.deleteSession(sessionId, otherSessionsData)
      };
    } catch (e) {
      this.log.error(`Had trouble ending session ${sessionId}: ${e.message}`);
      return {
        protocol,
        error: e
      };
    }
  }

  async deleteAllSessions(opts = {}) {
    const sessionsCount = _lodash.default.size(this.sessions);

    if (0 === sessionsCount) {
      this.log.debug('There are no active sessions for cleanup');
      return;
    }

    const {
      force = false,
      reason
    } = opts;
    this.log.debug(`Cleaning up ${_support.util.pluralize('active session', sessionsCount, true)}`);
    const cleanupPromises = force ? _lodash.default.values(this.sessions).map(drv => drv.startUnexpectedShutdown(reason && new Error(reason))) : _lodash.default.keys(this.sessions).map(id => this.deleteSession(id));

    for (const cleanupPromise of cleanupPromises) {
      try {
        await cleanupPromise;
      } catch (e) {
        this.log.debug(e);
      }
    }
  }

  pluginsForSession(sessionId = null) {
    if (sessionId) {
      if (!this.sessionPlugins[sessionId]) {
        this.sessionPlugins[sessionId] = this.createPluginInstances();
      }

      return this.sessionPlugins[sessionId];
    }

    if (_lodash.default.isEmpty(this.sessionlessPlugins)) {
      this.sessionlessPlugins = this.createPluginInstances();
    }

    return this.sessionlessPlugins;
  }

  pluginsToHandleCmd(cmd, sessionId = null) {
    return this.pluginsForSession(sessionId).filter(p => _lodash.default.isFunction(p[cmd]) || _lodash.default.isFunction(p.handle));
  }

  createPluginInstances() {
    const pluginInstances = [];

    for (const [PluginClass, name] of this.pluginClasses.entries()) {
      const cliArgs = this.getCliArgsForPlugin(name);
      const plugin = new PluginClass(name, cliArgs);
      pluginInstances.push(plugin);
    }

    return pluginInstances;
  }

  async executeCommand(cmd, ...args) {
    var _$last;

    const isGetStatus = cmd === _baseDriver.GET_STATUS_COMMAND;
    const isUmbrellaCmd = isAppiumDriverCommand(cmd);
    const isSessionCmd = (0, _baseDriver.isSessionCommand)(cmd);
    const reqForProxy = (_$last = _lodash.default.last(args)) === null || _$last === void 0 ? void 0 : _$last.reqForProxy;

    if (reqForProxy) {
      args.pop();
    }

    let sessionId = null;
    let dstSession = null;
    let protocol = null;
    let driver = this;

    if (isSessionCmd) {
      sessionId = _lodash.default.last(args);
      dstSession = this.sessions[sessionId];

      if (!dstSession) {
        throw new Error(`The session with id '${sessionId}' does not exist`);
      }

      protocol = dstSession.protocol;

      if (!isUmbrellaCmd) {
        driver = dstSession;
      }
    }

    const plugins = this.pluginsToHandleCmd(cmd, sessionId);
    const cmdHandledBy = {
      default: false
    };

    const defaultBehavior = async () => {
      plugins.length && this.log.info(`Executing default handling behavior for command '${cmd}'`);
      cmdHandledBy.default = true;

      if (reqForProxy) {
        if (!dstSession.proxyCommand) {
          throw new NoDriverProxyCommandError();
        }

        return await dstSession.proxyCommand(reqForProxy.originalUrl, reqForProxy.method, reqForProxy.body);
      }

      if (isGetStatus) {
        return await this.getStatus();
      }

      if (isUmbrellaCmd) {
        return await _baseDriver.BaseDriver.prototype.executeCommand.call(this, cmd, ...args);
      }

      return await dstSession.executeCommand(cmd, ...args);
    };

    const wrappedCmd = this.wrapCommandWithPlugins({
      driver,
      cmd,
      args,
      plugins,
      cmdHandledBy,
      next: defaultBehavior
    });
    const res = await this.executeWrappedCommand({
      wrappedCmd,
      protocol
    });
    this.logPluginHandlerReport(plugins, {
      cmd,
      cmdHandledBy
    });

    if (cmd === _baseDriver.CREATE_SESSION_COMMAND && this.sessionlessPlugins.length && !res.error) {
      const sessionId = _lodash.default.first(res.value);

      this.log.info(`Promoting ${this.sessionlessPlugins.length} sessionless plugins to be attached ` + `to session ID ${sessionId}`);
      this.sessionPlugins[sessionId] = this.sessionlessPlugins;
      this.sessionlessPlugins = [];
    }

    return res;
  }

  wrapCommandWithPlugins({
    driver,
    cmd,
    args,
    next,
    cmdHandledBy,
    plugins
  }) {
    plugins.length && this.log.info(`Plugins which can handle cmd '${cmd}': ${plugins.map(p => p.name)}`);

    for (const plugin of plugins) {
      cmdHandledBy[plugin.name] = false;

      next = (_next => async () => {
        this.log.info(`Plugin ${plugin.name} is now handling cmd '${cmd}'`);
        cmdHandledBy[plugin.name] = true;

        if (plugin[cmd]) {
          return await plugin[cmd](_next, driver, ...args);
        }

        return await plugin.handle(_next, driver, cmd, ...args);
      })(next);
    }

    return next;
  }

  logPluginHandlerReport(plugins, {
    cmd,
    cmdHandledBy
  }) {
    if (!plugins.length) {
      return;
    }

    const didHandle = Object.keys(cmdHandledBy).filter(k => cmdHandledBy[k]);
    const didntHandle = Object.keys(cmdHandledBy).filter(k => !cmdHandledBy[k]);

    if (didntHandle.length > 0) {
      this.log.info(`Command '${cmd}' was *not* handled by the following behaviours or plugins, even ` + `though they were registered to handle it: ${JSON.stringify(didntHandle)}. The ` + `command *was* handled by these: ${JSON.stringify(didHandle)}.`);
    }
  }

  async executeWrappedCommand({
    wrappedCmd,
    protocol
  }) {
    let cmdRes,
        cmdErr,
        res = {};

    try {
      cmdRes = await wrappedCmd();
    } catch (e) {
      cmdErr = e;
    }

    if (_lodash.default.isPlainObject(cmdRes) && _lodash.default.has(cmdRes, 'protocol')) {
      res = cmdRes;
    } else {
      res.value = cmdRes;
      res.error = cmdErr;
      res.protocol = protocol;
    }

    return res;
  }

  proxyActive(sessionId) {
    const dstSession = this.sessions[sessionId];
    return dstSession && _lodash.default.isFunction(dstSession.proxyActive) && dstSession.proxyActive(sessionId);
  }

  getProxyAvoidList(sessionId) {
    const dstSession = this.sessions[sessionId];
    return dstSession ? dstSession.getProxyAvoidList() : [];
  }

  canProxy(sessionId) {
    const dstSession = this.sessions[sessionId];
    return dstSession && dstSession.canProxy(sessionId);
  }

}

exports.AppiumDriver = AppiumDriver;

function isAppiumDriverCommand(cmd) {
  return !(0, _baseDriver.isSessionCommand)(cmd) || cmd === _baseDriver.DELETE_SESSION_COMMAND;
}

class NoDriverProxyCommandError extends Error {
  code = 'APPIUMERR_NO_DRIVER_PROXYCOMMAND';

  constructor() {
    super(`The default behavior for this command was to proxy, but the driver ` + `did not have the 'proxyCommand' method defined. To fully support ` + `plugins, drivers should have 'proxyCommand' set to a jwpProxy object's ` + `'command()' method, in addition to the normal 'proxyReqRes'`);
  }

}

exports.NoDriverProxyCommandError = NoDriverProxyCommandError;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkZXNpcmVkQ2FwYWJpbGl0eUNvbnN0cmFpbnRzIiwiT2JqZWN0IiwiZnJlZXplIiwiYXV0b21hdGlvbk5hbWUiLCJwcmVzZW5jZSIsImlzU3RyaW5nIiwicGxhdGZvcm1OYW1lIiwic2Vzc2lvbnNMaXN0R3VhcmQiLCJBc3luY0xvY2siLCJwZW5kaW5nRHJpdmVyc0d1YXJkIiwiQXBwaXVtRHJpdmVyIiwiRHJpdmVyQ29yZSIsInNlc3Npb25zIiwicGVuZGluZ0RyaXZlcnMiLCJuZXdDb21tYW5kVGltZW91dE1zIiwicGx1Z2luQ2xhc3NlcyIsInNlc3Npb25QbHVnaW5zIiwic2Vzc2lvbmxlc3NQbHVnaW5zIiwiZHJpdmVyQ29uZmlnIiwic2VydmVyIiwiZGVzaXJlZENhcENvbnN0cmFpbnRzIiwiYXJncyIsImNvbnN0cnVjdG9yIiwib3B0cyIsInRtcERpciIsInByb2Nlc3MiLCJlbnYiLCJBUFBJVU1fVE1QX0RJUiIsInVwZGF0ZUJ1aWxkSW5mbyIsImNhdGNoIiwiZXJyIiwibG9nIiwiZGVidWciLCJfbG9nIiwiaW5zdGFuY2VOYW1lIiwibmFtZSIsIm5vZGUiLCJnZXRPYmplY3RJZCIsInN1YnN0cmluZyIsImxvZ2dlciIsImdldExvZ2dlciIsImlzQ29tbWFuZHNRdWV1ZUVuYWJsZWQiLCJzZXNzaW9uRXhpc3RzIiwic2Vzc2lvbklkIiwiZHN0U2Vzc2lvbiIsImRyaXZlckZvclNlc3Npb24iLCJnZXRTdGF0dXMiLCJidWlsZCIsIl8iLCJjbG9uZSIsImdldEJ1aWxkSW5mbyIsImdldFNlc3Npb25zIiwidG9QYWlycyIsIm1hcCIsImlkIiwiZHJpdmVyIiwiY2FwYWJpbGl0aWVzIiwiY2FwcyIsInByaW50TmV3U2Vzc2lvbkFubm91bmNlbWVudCIsImRyaXZlck5hbWUiLCJkcml2ZXJWZXJzaW9uIiwiZHJpdmVyQmFzZVZlcnNpb24iLCJpbmZvIiwiQVBQSVVNX1ZFUiIsImJhc2VWZXJzaW9uIiwiZ2V0Q2xpQXJnc0ZvclBsdWdpbiIsImV4dE5hbWUiLCJwbHVnaW4iLCJnZXRDbGlBcmdzRm9yRHJpdmVyIiwiYWxsQ2xpQXJnc0ZvckV4dCIsImlzRW1wdHkiLCJkZWZhdWx0cyIsImdldERlZmF1bHRzRm9yRXh0ZW5zaW9uIiwiRFJJVkVSX1RZUEUiLCJjbGlBcmdzIiwib21pdEJ5IiwidmFsdWUiLCJrZXkiLCJpc0VxdWFsIiwiY3JlYXRlU2Vzc2lvbiIsImpzb253cENhcHMiLCJyZXFDYXBzIiwidzNjQ2FwYWJpbGl0aWVzIiwiZHJpdmVyRGF0YSIsImRlZmF1bHRDYXBhYmlsaXRpZXMiLCJjbG9uZURlZXAiLCJkZWZhdWx0U2V0dGluZ3MiLCJwdWxsU2V0dGluZ3MiLCJqd3BTZXR0aW5ncyIsInczY1NldHRpbmdzIiwiYWx3YXlzTWF0Y2giLCJmaXJzdE1hdGNoRW50cnkiLCJmaXJzdE1hdGNoIiwiYXNzaWduIiwicHJvdG9jb2wiLCJpbm5lclNlc3Npb25JZCIsImRDYXBzIiwicGFyc2VkQ2FwcyIsInBhcnNlQ2Fwc0ZvcklubmVyRHJpdmVyIiwiZGVzaXJlZENhcHMiLCJwcm9jZXNzZWRKc29ud3BDYXBhYmlsaXRpZXMiLCJwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXMiLCJlcnJvciIsIklubmVyRHJpdmVyIiwidmVyc2lvbiIsImZpbmRNYXRjaGluZ0RyaXZlciIsInNlc3Npb25PdmVycmlkZSIsImRlbGV0ZUFsbFNlc3Npb25zIiwicnVubmluZ0RyaXZlcnNEYXRhIiwib3RoZXJQZW5kaW5nRHJpdmVyc0RhdGEiLCJkcml2ZXJJbnN0YW5jZSIsInJlbGF4ZWRTZWN1cml0eUVuYWJsZWQiLCJkZW55SW5zZWN1cmUiLCJhIiwiYWxsb3dJbnNlY3VyZSIsInNlcnZlckhvc3QiLCJhZGRyZXNzIiwic2VydmVyUG9ydCIsInBvcnQiLCJzZXJ2ZXJQYXRoIiwiYmFzZVBhdGgiLCJjdXJTZXNzaW9uRGF0YUZvckRyaXZlciIsImUiLCJlcnJvcnMiLCJTZXNzaW9uTm90Q3JlYXRlZEVycm9yIiwibWVzc2FnZSIsImFjcXVpcmUiLCJjb21wYWN0IiwiZHJ2IiwicHVzaCIsInB1bGwiLCJhdHRhY2hVbmV4cGVjdGVkU2h1dGRvd25IYW5kbGVyIiwic3RhcnROZXdDb21tYW5kVGltZW91dCIsImlzVzNDUHJvdG9jb2wiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlU2V0dGluZ3MiLCJpc01qc29ud3BQcm90b2NvbCIsIm9uU2h1dGRvd24iLCJjYXVzZSIsIkVycm9yIiwid2FybiIsImlzRnVuY3Rpb24iLCJvblVuZXhwZWN0ZWRTaHV0ZG93biIsImRhdGEiLCJ2YWx1ZXMiLCJmaWx0ZXIiLCJzIiwiZGF0dW0iLCJkZWxldGVTZXNzaW9uIiwib3RoZXJTZXNzaW9uc0RhdGEiLCJjdXJDb25zdHJ1Y3Rvck5hbWUiLCJzZXNzaW9uc0NvdW50Iiwic2l6ZSIsImZvcmNlIiwicmVhc29uIiwidXRpbCIsInBsdXJhbGl6ZSIsImNsZWFudXBQcm9taXNlcyIsInN0YXJ0VW5leHBlY3RlZFNodXRkb3duIiwia2V5cyIsImNsZWFudXBQcm9taXNlIiwicGx1Z2luc0ZvclNlc3Npb24iLCJjcmVhdGVQbHVnaW5JbnN0YW5jZXMiLCJwbHVnaW5zVG9IYW5kbGVDbWQiLCJjbWQiLCJwIiwiaGFuZGxlIiwicGx1Z2luSW5zdGFuY2VzIiwiUGx1Z2luQ2xhc3MiLCJlbnRyaWVzIiwiZXhlY3V0ZUNvbW1hbmQiLCJpc0dldFN0YXR1cyIsIkdFVF9TVEFUVVNfQ09NTUFORCIsImlzVW1icmVsbGFDbWQiLCJpc0FwcGl1bURyaXZlckNvbW1hbmQiLCJpc1Nlc3Npb25DbWQiLCJpc1Nlc3Npb25Db21tYW5kIiwicmVxRm9yUHJveHkiLCJsYXN0IiwicG9wIiwicGx1Z2lucyIsImNtZEhhbmRsZWRCeSIsImRlZmF1bHQiLCJkZWZhdWx0QmVoYXZpb3IiLCJsZW5ndGgiLCJwcm94eUNvbW1hbmQiLCJOb0RyaXZlclByb3h5Q29tbWFuZEVycm9yIiwib3JpZ2luYWxVcmwiLCJtZXRob2QiLCJib2R5IiwiQmFzZURyaXZlciIsInByb3RvdHlwZSIsImNhbGwiLCJ3cmFwcGVkQ21kIiwid3JhcENvbW1hbmRXaXRoUGx1Z2lucyIsIm5leHQiLCJyZXMiLCJleGVjdXRlV3JhcHBlZENvbW1hbmQiLCJsb2dQbHVnaW5IYW5kbGVyUmVwb3J0IiwiQ1JFQVRFX1NFU1NJT05fQ09NTUFORCIsImZpcnN0IiwiX25leHQiLCJkaWRIYW5kbGUiLCJrIiwiZGlkbnRIYW5kbGUiLCJjbWRSZXMiLCJjbWRFcnIiLCJpc1BsYWluT2JqZWN0IiwiaGFzIiwicHJveHlBY3RpdmUiLCJnZXRQcm94eUF2b2lkTGlzdCIsImNhblByb3h5IiwiREVMRVRFX1NFU1NJT05fQ09NTUFORCIsImNvZGUiXSwic291cmNlcyI6WyIuLi8uLi9saWIvYXBwaXVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzICovXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHtnZXRCdWlsZEluZm8sIHVwZGF0ZUJ1aWxkSW5mbywgQVBQSVVNX1ZFUn0gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHtcbiAgQmFzZURyaXZlcixcbiAgRHJpdmVyQ29yZSxcbiAgZXJyb3JzLFxuICBpc1Nlc3Npb25Db21tYW5kLFxuICBDUkVBVEVfU0VTU0lPTl9DT01NQU5ELFxuICBERUxFVEVfU0VTU0lPTl9DT01NQU5ELFxuICBHRVRfU1RBVFVTX0NPTU1BTkQsXG59IGZyb20gJ0BhcHBpdW0vYmFzZS1kcml2ZXInO1xuaW1wb3J0IEFzeW5jTG9jayBmcm9tICdhc3luYy1sb2NrJztcbmltcG9ydCB7cGFyc2VDYXBzRm9ySW5uZXJEcml2ZXIsIHB1bGxTZXR0aW5nc30gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQge3V0aWwsIG5vZGUsIGxvZ2dlcn0gZnJvbSAnQGFwcGl1bS9zdXBwb3J0JztcbmltcG9ydCB7Z2V0RGVmYXVsdHNGb3JFeHRlbnNpb259IGZyb20gJy4vc2NoZW1hJztcbmltcG9ydCB7RFJJVkVSX1RZUEUsIFBMVUdJTl9UWVBFfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbi8qKlxuICogSW52YXJpYW50IHNldCBvZiBiYXNlIGNvbnN0cmFpbnRzXG4gKiBAdHlwZSB7UmVhZG9ubHk8Q29uc3RyYWludHM+fVxuICovXG5jb25zdCBkZXNpcmVkQ2FwYWJpbGl0eUNvbnN0cmFpbnRzID0gT2JqZWN0LmZyZWV6ZSh7XG4gIGF1dG9tYXRpb25OYW1lOiB7XG4gICAgcHJlc2VuY2U6IHRydWUsXG4gICAgaXNTdHJpbmc6IHRydWUsXG4gIH0sXG4gIHBsYXRmb3JtTmFtZToge1xuICAgIHByZXNlbmNlOiB0cnVlLFxuICAgIGlzU3RyaW5nOiB0cnVlLFxuICB9LFxufSk7XG5cbmNvbnN0IHNlc3Npb25zTGlzdEd1YXJkID0gbmV3IEFzeW5jTG9jaygpO1xuY29uc3QgcGVuZGluZ0RyaXZlcnNHdWFyZCA9IG5ldyBBc3luY0xvY2soKTtcblxuLyoqXG4gKiBAaW1wbGVtZW50cyB7U2Vzc2lvbkhhbmRsZXJ9XG4gKi9cbmNsYXNzIEFwcGl1bURyaXZlciBleHRlbmRzIERyaXZlckNvcmUge1xuICAvKipcbiAgICogQWNjZXNzIHRvIHNlc3Npb25zIGxpc3QgbXVzdCBiZSBndWFyZGVkIHdpdGggYSBTZW1hcGhvcmUsIGJlY2F1c2VcbiAgICogaXQgbWlnaHQgYmUgY2hhbmdlZCBieSBvdGhlciBhc3luYyBjYWxscyBhdCBhbnkgdGltZVxuICAgKiBJdCBpcyBub3QgcmVjb21tZW5kZWQgdG8gYWNjZXNzIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkgZnJvbSB0aGUgb3V0c2lkZVxuICAgKiBAdHlwZSB7UmVjb3JkPHN0cmluZyxFeHRlcm5hbERyaXZlcj59XG4gICAqL1xuICBzZXNzaW9ucyA9IHt9O1xuXG4gIC8qKlxuICAgKiBBY2Nlc3MgdG8gcGVuZGluZyBkcml2ZXJzIGxpc3QgbXVzdCBiZSBndWFyZGVkIHdpdGggYSBTZW1hcGhvcmUsIGJlY2F1c2VcbiAgICogaXQgbWlnaHQgYmUgY2hhbmdlZCBieSBvdGhlciBhc3luYyBjYWxscyBhdCBhbnkgdGltZVxuICAgKiBJdCBpcyBub3QgcmVjb21tZW5kZWQgdG8gYWNjZXNzIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkgZnJvbSB0aGUgb3V0c2lkZVxuICAgKiBAdHlwZSB7UmVjb3JkPHN0cmluZyxFeHRlcm5hbERyaXZlcltdPn1cbiAgICovXG4gIHBlbmRpbmdEcml2ZXJzID0ge307XG5cbiAgLyoqXG4gICAqIE5vdGUgdGhhdCB7QGxpbmtjb2RlIEFwcGl1bURyaXZlcn0gaGFzIG5vIGBuZXdDb21tYW5kVGltZW91dGAgbWV0aG9kLlxuICAgKiBgQXBwaXVtRHJpdmVyYCBkb2VzIG5vdCBzZXQgYW5kIG9ic2VydmUgaXRzIG93biB0aW1lb3V0czsgaW5kaXZpZHVhbFxuICAgKiBzZXNzaW9ucyAobWFuYWdlZCBkcml2ZXJzKSBkbyBpbnN0ZWFkLlxuICAgKi9cbiAgbmV3Q29tbWFuZFRpbWVvdXRNcyA9IDA7XG5cbiAgLyoqXG4gICAqIExpc3Qgb2YgYWN0aXZlIHBsdWdpbnNcbiAgICogQHR5cGUge01hcDxQbHVnaW5DbGFzcyxzdHJpbmc+fVxuICAgKi9cbiAgcGx1Z2luQ2xhc3NlcztcblxuICAvKipcbiAgICogbWFwIG9mIHNlc3Npb25zIHRvIGFjdHVhbCBwbHVnaW4gaW5zdGFuY2VzIHBlciBzZXNzaW9uXG4gICAqIEB0eXBlIHtSZWNvcmQ8c3RyaW5nLEluc3RhbmNlVHlwZTxQbHVnaW5DbGFzcz5bXT59XG4gICAqL1xuICBzZXNzaW9uUGx1Z2lucyA9IHt9O1xuXG4gIC8qKlxuICAgKiBzb21lIGNvbW1hbmRzIGFyZSBzZXNzaW9ubGVzcywgc28gd2UgbmVlZCBhIHNldCBvZiBwbHVnaW5zIGZvciB0aGVtXG4gICAqIEB0eXBlIHtJbnN0YW5jZVR5cGU8UGx1Z2luQ2xhc3M+W119XG4gICAqL1xuICBzZXNzaW9ubGVzc1BsdWdpbnMgPSBbXTtcblxuICAvKiogQHR5cGUge0RyaXZlckNvbmZpZ30gKi9cbiAgZHJpdmVyQ29uZmlnO1xuXG4gIC8qKiBAdHlwZSB7QXBwaXVtU2VydmVyfSAqL1xuICBzZXJ2ZXI7XG5cbiAgZGVzaXJlZENhcENvbnN0cmFpbnRzID0gZGVzaXJlZENhcGFiaWxpdHlDb25zdHJhaW50cztcblxuICAvKiogQHR5cGUge0RyaXZlck9wdHN9ICovXG4gIGFyZ3M7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7RHJpdmVyT3B0c30gb3B0c1xuICAgKi9cbiAgY29uc3RydWN0b3Iob3B0cykge1xuICAgIC8vIEl0IGlzIG5lY2Vzc2FyeSB0byBzZXQgYC0tdG1wYCBoZXJlIHNpbmNlIGl0IHNob3VsZCBiZSBzZXQgdG9cbiAgICAvLyBwcm9jZXNzLmVudi5BUFBJVU1fVE1QX0RJUiBvbmNlIGF0IGFuIGluaXRpYWwgcG9pbnQgaW4gdGhlIEFwcGl1bSBsaWZlY3ljbGUuXG4gICAgLy8gVGhlIHByb2Nlc3MgYXJndW1lbnQgd2lsbCBiZSByZWZlcmVuY2VkIGJ5IEJhc2VEcml2ZXIuXG4gICAgLy8gUGxlYXNlIGNhbGwgQGFwcGl1bS9zdXBwb3J0LnRlbXBEaXIgbW9kdWxlIHRvIGFwcGx5IHRoaXMgYmVuZWZpdC5cbiAgICBpZiAob3B0cy50bXBEaXIpIHtcbiAgICAgIHByb2Nlc3MuZW52LkFQUElVTV9UTVBfRElSID0gb3B0cy50bXBEaXI7XG4gICAgfVxuXG4gICAgc3VwZXIob3B0cyk7XG5cbiAgICB0aGlzLmFyZ3MgPSB7Li4ub3B0c307XG5cbiAgICAvLyBhbGxvdyB0aGlzIHRvIGhhcHBlbiBpbiB0aGUgYmFja2dyb3VuZCwgc28gbm8gYGF3YWl0YFxuICAgIC8vIGNhdGNoIHRoaXMgdG8gYXZvaWQgYW4gdW5oYW5kbGVkIHJlamVjdGlvblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcm9taXNlL3ByZWZlci1hd2FpdC10by10aGVuLHByb21pc2UvcHJlZmVyLWF3YWl0LXRvLWNhbGxiYWNrc1xuICAgIHVwZGF0ZUJ1aWxkSW5mbygpLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIHRoaXMubG9nLmRlYnVnKGVycik7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIGxvZ2dlciBpbnN0YW5jZSBmb3IgdGhlIGN1cnJlbnQgdW1icmVsbGEgZHJpdmVyIGluc3RhbmNlXG4gICAqL1xuICBnZXQgbG9nKCkge1xuICAgIGlmICghdGhpcy5fbG9nKSB7XG4gICAgICBjb25zdCBpbnN0YW5jZU5hbWUgPSBgJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9QCR7bm9kZS5nZXRPYmplY3RJZCh0aGlzKS5zdWJzdHJpbmcoMCwgNCl9YDtcbiAgICAgIHRoaXMuX2xvZyA9IGxvZ2dlci5nZXRMb2dnZXIoaW5zdGFuY2VOYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2xvZztcbiAgfVxuXG4gIC8qKlxuICAgKiBDYW5jZWwgY29tbWFuZHMgcXVldWVpbmcgZm9yIHRoZSB1bWJyZWxsYSBBcHBpdW0gZHJpdmVyXG4gICAqL1xuICBnZXQgaXNDb21tYW5kc1F1ZXVlRW5hYmxlZCgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBzZXNzaW9uRXhpc3RzKHNlc3Npb25JZCkge1xuICAgIGNvbnN0IGRzdFNlc3Npb24gPSB0aGlzLnNlc3Npb25zW3Nlc3Npb25JZF07XG4gICAgcmV0dXJuIGRzdFNlc3Npb24gJiYgZHN0U2Vzc2lvbi5zZXNzaW9uSWQgIT09IG51bGw7XG4gIH1cblxuICBkcml2ZXJGb3JTZXNzaW9uKHNlc3Npb25JZCkge1xuICAgIHJldHVybiB0aGlzLnNlc3Npb25zW3Nlc3Npb25JZF07XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVxdWlyZS1hd2FpdFxuICBhc3luYyBnZXRTdGF0dXMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJ1aWxkOiBfLmNsb25lKGdldEJ1aWxkSW5mbygpKSxcbiAgICB9O1xuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlcXVpcmUtYXdhaXRcbiAgYXN5bmMgZ2V0U2Vzc2lvbnMoKSB7XG4gICAgcmV0dXJuIF8udG9QYWlycyh0aGlzLnNlc3Npb25zKS5tYXAoKFtpZCwgZHJpdmVyXSkgPT4gKHtcbiAgICAgIGlkLFxuICAgICAgY2FwYWJpbGl0aWVzOiBkcml2ZXIuY2FwcyxcbiAgICB9KSk7XG4gIH1cblxuICBwcmludE5ld1Nlc3Npb25Bbm5vdW5jZW1lbnQoZHJpdmVyTmFtZSwgZHJpdmVyVmVyc2lvbiwgZHJpdmVyQmFzZVZlcnNpb24pIHtcbiAgICB0aGlzLmxvZy5pbmZvKFxuICAgICAgZHJpdmVyVmVyc2lvblxuICAgICAgICA/IGBBcHBpdW0gdiR7QVBQSVVNX1ZFUn0gY3JlYXRpbmcgbmV3ICR7ZHJpdmVyTmFtZX0gKHYke2RyaXZlclZlcnNpb259KSBzZXNzaW9uYFxuICAgICAgICA6IGBBcHBpdW0gdiR7QVBQSVVNX1ZFUn0gY3JlYXRpbmcgbmV3ICR7ZHJpdmVyTmFtZX0gc2Vzc2lvbmBcbiAgICApO1xuICAgIHRoaXMubG9nLmluZm8oYENoZWNraW5nIEJhc2VEcml2ZXIgdmVyc2lvbnMgZm9yIEFwcGl1bSBhbmQgJHtkcml2ZXJOYW1lfWApO1xuICAgIHRoaXMubG9nLmluZm8oXG4gICAgICBBcHBpdW1Ecml2ZXIuYmFzZVZlcnNpb25cbiAgICAgICAgPyBgQXBwaXVtJ3MgQmFzZURyaXZlciB2ZXJzaW9uIGlzICR7QXBwaXVtRHJpdmVyLmJhc2VWZXJzaW9ufWBcbiAgICAgICAgOiBgQ291bGQgbm90IGRldGVybWluZSBBcHBpdW0ncyBCYXNlRHJpdmVyIHZlcnNpb25gXG4gICAgKTtcbiAgICB0aGlzLmxvZy5pbmZvKFxuICAgICAgZHJpdmVyQmFzZVZlcnNpb25cbiAgICAgICAgPyBgJHtkcml2ZXJOYW1lfSdzIEJhc2VEcml2ZXIgdmVyc2lvbiBpcyAke2RyaXZlckJhc2VWZXJzaW9ufWBcbiAgICAgICAgOiBgQ291bGQgbm90IGRldGVybWluZSAke2RyaXZlck5hbWV9J3MgQmFzZURyaXZlciB2ZXJzaW9uYFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIGFsbCBDTEkgYXJndW1lbnRzIGZvciBhIHNwZWNpZmljIHBsdWdpbi5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGV4dE5hbWUgLSBQbHVnaW4gbmFtZVxuICAgKiBAcmV0dXJucyB7UmVjb3JkPHN0cmluZyx1bmtub3duPn0gQXJndW1lbnRzIG9iamVjdC4gSWYgbm9uZSwgYW4gZW1wdHkgb2JqZWN0LlxuICAgKi9cbiAgZ2V0Q2xpQXJnc0ZvclBsdWdpbihleHROYW1lKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7UmVjb3JkPHN0cmluZyx1bmtub3duPn0gKi8gKHRoaXMuYXJncy5wbHVnaW4/LltleHROYW1lXSA/PyB7fSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIENMSSBhcmdzIGZvciBhIHNwZWNpZmljIGRyaXZlci5cbiAgICpcbiAgICogX0FueSBhcmcgd2hpY2ggaXMgZXF1YWwgdG8gaXRzIGRlZmF1bHQgdmFsdWUgd2lsbCBub3QgYmUgcHJlc2VudCBpbiB0aGUgcmV0dXJuZWQgb2JqZWN0Ll9cbiAgICpcbiAgICogX05vdGUgdGhhdCB0aGlzIGJlaGF2aW9yIGN1cnJlbnRseSAoTWF5IDE4IDIwMjIpIGRpZmZlcnMgZnJvbSBob3cgcGx1Z2lucyBhcmUgaGFuZGxlZF8gKHNlZSB7QGxpbmtjb2RlIEFwcGl1bURyaXZlci5nZXRDbGlBcmdzRm9yUGx1Z2lufSkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBleHROYW1lIC0gRHJpdmVyIG5hbWVcbiAgICogQHJldHVybnMge1JlY29yZDxzdHJpbmcsdW5rbm93bj58dW5kZWZpbmVkfSBBcmd1bWVudHMgb2JqZWN0LiBJZiBub25lLCBgdW5kZWZpbmVkYFxuICAgKi9cbiAgZ2V0Q2xpQXJnc0ZvckRyaXZlcihleHROYW1lKSB7XG4gICAgY29uc3QgYWxsQ2xpQXJnc0ZvckV4dCA9IC8qKiBAdHlwZSB7UmVjb3JkPHN0cmluZyx1bmtub3duPnx1bmRlZmluZWR9ICovIChcbiAgICAgIHRoaXMuYXJncy5kcml2ZXI/LltleHROYW1lXVxuICAgICk7XG5cbiAgICBpZiAoIV8uaXNFbXB0eShhbGxDbGlBcmdzRm9yRXh0KSkge1xuICAgICAgY29uc3QgZGVmYXVsdHMgPSBnZXREZWZhdWx0c0ZvckV4dGVuc2lvbihEUklWRVJfVFlQRSwgZXh0TmFtZSk7XG4gICAgICBjb25zdCBjbGlBcmdzID0gXy5pc0VtcHR5KGRlZmF1bHRzKVxuICAgICAgICA/IGFsbENsaUFyZ3NGb3JFeHRcbiAgICAgICAgOiBfLm9taXRCeShhbGxDbGlBcmdzRm9yRXh0LCAodmFsdWUsIGtleSkgPT4gXy5pc0VxdWFsKGRlZmF1bHRzW2tleV0sIHZhbHVlKSk7XG4gICAgICBpZiAoIV8uaXNFbXB0eShjbGlBcmdzKSkge1xuICAgICAgICByZXR1cm4gY2xpQXJncztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IHNlc3Npb25cbiAgICogQHBhcmFtIHtXM0NDYXBhYmlsaXRpZXN9IGpzb253cENhcHMgSlNPTldQIGZvcm1hdHRlZCBkZXNpcmVkIGNhcGFiaWxpdGllc1xuICAgKiBAcGFyYW0ge1czQ0NhcGFiaWxpdGllc30gcmVxQ2FwcyBSZXF1aXJlZCBjYXBhYmlsaXRpZXMgKEpTT05XUCBzdGFuZGFyZClcbiAgICogQHBhcmFtIHtXM0NDYXBhYmlsaXRpZXN9IHczY0NhcGFiaWxpdGllcyBXM0MgY2FwYWJpbGl0aWVzXG4gICAqIEBwYXJhbSB7RHJpdmVyRGF0YVtdfSBbZHJpdmVyRGF0YV1cbiAgICovXG4gIGFzeW5jIGNyZWF0ZVNlc3Npb24oanNvbndwQ2FwcywgcmVxQ2FwcywgdzNjQ2FwYWJpbGl0aWVzLCBkcml2ZXJEYXRhKSB7XG4gICAgY29uc3QgZGVmYXVsdENhcGFiaWxpdGllcyA9IF8uY2xvbmVEZWVwKHRoaXMuYXJncy5kZWZhdWx0Q2FwYWJpbGl0aWVzKTtcbiAgICBjb25zdCBkZWZhdWx0U2V0dGluZ3MgPSBwdWxsU2V0dGluZ3MoZGVmYXVsdENhcGFiaWxpdGllcyk7XG4gICAganNvbndwQ2FwcyA9IF8uY2xvbmVEZWVwKGpzb253cENhcHMpO1xuICAgIGNvbnN0IGp3cFNldHRpbmdzID0gey4uLmRlZmF1bHRTZXR0aW5ncywgLi4ucHVsbFNldHRpbmdzKGpzb253cENhcHMpfTtcbiAgICB3M2NDYXBhYmlsaXRpZXMgPSBfLmNsb25lRGVlcCh3M2NDYXBhYmlsaXRpZXMpO1xuICAgIC8vIEl0IGlzIHBvc3NpYmxlIHRoYXQgdGhlIGNsaWVudCBvbmx5IHByb3ZpZGVzIGNhcHMgdXNpbmcgSlNPTldQIHN0YW5kYXJkLFxuICAgIC8vIGFsdGhvdWdoIGZpcnN0TWF0Y2gvYWx3YXlzTWF0Y2ggcHJvcGVydGllcyBhcmUgc3RpbGwgcHJlc2VudC5cbiAgICAvLyBJbiBzdWNoIGNhc2Ugd2UgYXNzdW1lIHRoZSBjbGllbnQgdW5kZXJzdGFuZHMgVzNDIHByb3RvY29sIGFuZCBtZXJnZSB0aGUgZ2l2ZW5cbiAgICAvLyBKU09OV1AgY2FwcyB0byBXM0MgY2Fwc1xuICAgIGNvbnN0IHczY1NldHRpbmdzID0ge1xuICAgICAgLi4uandwU2V0dGluZ3MsXG4gICAgICAuLi5wdWxsU2V0dGluZ3MoKHczY0NhcGFiaWxpdGllcyA/PyB7fSkuYWx3YXlzTWF0Y2ggPz8ge30pLFxuICAgIH07XG4gICAgZm9yIChjb25zdCBmaXJzdE1hdGNoRW50cnkgb2YgKHczY0NhcGFiaWxpdGllcyA/PyB7fSkuZmlyc3RNYXRjaCA/PyBbXSkge1xuICAgICAgT2JqZWN0LmFzc2lnbih3M2NTZXR0aW5ncywgcHVsbFNldHRpbmdzKGZpcnN0TWF0Y2hFbnRyeSkpO1xuICAgIH1cblxuICAgIGxldCBwcm90b2NvbDtcbiAgICBsZXQgaW5uZXJTZXNzaW9uSWQsIGRDYXBzO1xuICAgIHRyeSB7XG4gICAgICAvLyBQYXJzZSB0aGUgY2FwcyBpbnRvIGEgZm9ybWF0IHRoYXQgdGhlIElubmVyRHJpdmVyIHdpbGwgYWNjZXB0XG4gICAgICBjb25zdCBwYXJzZWRDYXBzID0gcGFyc2VDYXBzRm9ySW5uZXJEcml2ZXIoXG4gICAgICAgIGpzb253cENhcHMsXG4gICAgICAgIHczY0NhcGFiaWxpdGllcyxcbiAgICAgICAgdGhpcy5kZXNpcmVkQ2FwQ29uc3RyYWludHMsXG4gICAgICAgIGRlZmF1bHRDYXBhYmlsaXRpZXNcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHtkZXNpcmVkQ2FwcywgcHJvY2Vzc2VkSnNvbndwQ2FwYWJpbGl0aWVzLCBwcm9jZXNzZWRXM0NDYXBhYmlsaXRpZXN9ID1cbiAgICAgICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4vdXRpbHMnKS5QYXJzZWREcml2ZXJDYXBzfSAqLyAocGFyc2VkQ2Fwcyk7XG4gICAgICBwcm90b2NvbCA9IHBhcnNlZENhcHMucHJvdG9jb2w7XG4gICAgICBjb25zdCBlcnJvciA9IC8qKiBAdHlwZSB7aW1wb3J0KCcuL3V0aWxzJykuSW52YWxpZENhcHN9ICovIChwYXJzZWRDYXBzKS5lcnJvcjtcbiAgICAgIC8vIElmIHRoZSBwYXJzaW5nIG9mIHRoZSBjYXBzIHByb2R1Y2VkIGFuIGVycm9yLCB0aHJvdyBpdCBpbiBoZXJlXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZHJpdmVyOiBJbm5lckRyaXZlcixcbiAgICAgICAgdmVyc2lvbjogZHJpdmVyVmVyc2lvbixcbiAgICAgICAgZHJpdmVyTmFtZSxcbiAgICAgIH0gPSB0aGlzLmRyaXZlckNvbmZpZy5maW5kTWF0Y2hpbmdEcml2ZXIoZGVzaXJlZENhcHMpO1xuICAgICAgdGhpcy5wcmludE5ld1Nlc3Npb25Bbm5vdW5jZW1lbnQoSW5uZXJEcml2ZXIubmFtZSwgZHJpdmVyVmVyc2lvbiwgSW5uZXJEcml2ZXIuYmFzZVZlcnNpb24pO1xuXG4gICAgICBpZiAodGhpcy5hcmdzLnNlc3Npb25PdmVycmlkZSkge1xuICAgICAgICBhd2FpdCB0aGlzLmRlbGV0ZUFsbFNlc3Npb25zKCk7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICogQHR5cGUge0RyaXZlckRhdGFbXX1cbiAgICAgICAqL1xuICAgICAgbGV0IHJ1bm5pbmdEcml2ZXJzRGF0YSA9IFtdO1xuICAgICAgLyoqXG4gICAgICAgKiBAdHlwZSB7RHJpdmVyRGF0YVtdfVxuICAgICAgICovXG4gICAgICBsZXQgb3RoZXJQZW5kaW5nRHJpdmVyc0RhdGEgPSBbXTtcblxuICAgICAgY29uc3QgZHJpdmVySW5zdGFuY2UgPSBuZXcgSW5uZXJEcml2ZXIodGhpcy5hcmdzLCB0cnVlKTtcblxuICAgICAgLy8gV2Ugd2FudCB0byBhc3NpZ24gc2VjdXJpdHkgdmFsdWVzIGRpcmVjdGx5IG9uIHRoZSBkcml2ZXIuIFRoZSBkcml2ZXJcbiAgICAgIC8vIHNob3VsZCBub3QgcmVhZCBzZWN1cml0eSB2YWx1ZXMgZnJvbSBgdGhpcy5vcHRzYCBiZWNhdXNlIHRob3NlIHZhbHVlc1xuICAgICAgLy8gY291bGQgaGF2ZSBiZWVuIHNldCBieSBhIG1hbGljaW91cyB1c2VyIHZpYSBjYXBhYmlsaXRpZXMsIHdoZXJlYXMgd2VcbiAgICAgIC8vIHdhbnQgYSBndWFyYW50ZWUgdGhlIHZhbHVlcyB3ZXJlIHNldCBieSB0aGUgYXBwaXVtIHNlcnZlciBhZG1pblxuICAgICAgaWYgKHRoaXMuYXJncy5yZWxheGVkU2VjdXJpdHlFbmFibGVkKSB7XG4gICAgICAgIHRoaXMubG9nLmluZm8oXG4gICAgICAgICAgYEFwcGx5aW5nIHJlbGF4ZWQgc2VjdXJpdHkgdG8gJyR7SW5uZXJEcml2ZXIubmFtZX0nIGFzIHBlciBgICtcbiAgICAgICAgICAgIGBzZXJ2ZXIgY29tbWFuZCBsaW5lIGFyZ3VtZW50LiBBbGwgaW5zZWN1cmUgZmVhdHVyZXMgd2lsbCBiZSBgICtcbiAgICAgICAgICAgIGBlbmFibGVkIHVubGVzcyBleHBsaWNpdGx5IGRpc2FibGVkIGJ5IC0tZGVueS1pbnNlY3VyZWBcbiAgICAgICAgKTtcbiAgICAgICAgZHJpdmVySW5zdGFuY2UucmVsYXhlZFNlY3VyaXR5RW5hYmxlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmICghXy5pc0VtcHR5KHRoaXMuYXJncy5kZW55SW5zZWN1cmUpKSB7XG4gICAgICAgIHRoaXMubG9nLmluZm8oJ0V4cGxpY2l0bHkgcHJldmVudGluZyB1c2Ugb2YgaW5zZWN1cmUgZmVhdHVyZXM6Jyk7XG4gICAgICAgIHRoaXMuYXJncy5kZW55SW5zZWN1cmUubWFwKChhKSA9PiB0aGlzLmxvZy5pbmZvKGAgICAgJHthfWApKTtcbiAgICAgICAgZHJpdmVySW5zdGFuY2UuZGVueUluc2VjdXJlID0gdGhpcy5hcmdzLmRlbnlJbnNlY3VyZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFfLmlzRW1wdHkodGhpcy5hcmdzLmFsbG93SW5zZWN1cmUpKSB7XG4gICAgICAgIHRoaXMubG9nLmluZm8oJ0V4cGxpY2l0bHkgZW5hYmxpbmcgdXNlIG9mIGluc2VjdXJlIGZlYXR1cmVzOicpO1xuICAgICAgICB0aGlzLmFyZ3MuYWxsb3dJbnNlY3VyZS5tYXAoKGEpID0+IHRoaXMubG9nLmluZm8oYCAgICAke2F9YCkpO1xuICAgICAgICBkcml2ZXJJbnN0YW5jZS5hbGxvd0luc2VjdXJlID0gdGhpcy5hcmdzLmFsbG93SW5zZWN1cmU7XG4gICAgICB9XG5cbiAgICAgIC8vIExpa2V3aXNlLCBhbnkgZHJpdmVyLXNwZWNpZmljIENMSSBhcmdzIHRoYXQgd2VyZSBwYXNzZWQgaW4gc2hvdWxkIGJlIGFzc2lnbmVkIGRpcmVjdGx5IHRvXG4gICAgICAvLyB0aGUgZHJpdmVyIHNvIHRoYXQgdGhleSBjYW5ub3QgYmUgbWltaWNrZWQgYnkgYSBtYWxpY2lvdXMgdXNlciBzZW5kaW5nIGluIGNhcGFiaWxpdGllc1xuICAgICAgY29uc3QgY2xpQXJncyA9IHRoaXMuZ2V0Q2xpQXJnc0ZvckRyaXZlcihkcml2ZXJOYW1lKTtcbiAgICAgIGlmICghXy5pc0VtcHR5KGNsaUFyZ3MpKSB7XG4gICAgICAgIGRyaXZlckluc3RhbmNlLmNsaUFyZ3MgPSBjbGlBcmdzO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGlzIGFzc2lnbm1lbnQgaXMgcmVxdWlyZWQgZm9yIGNvcnJlY3Qgd2ViIHNvY2tldHMgZnVuY3Rpb25hbGl0eSBpbnNpZGUgdGhlIGRyaXZlclxuICAgICAgLy8gRHJpdmVycy9wbHVnaW5zIG1pZ2h0IGFsc28gd2FudCB0byBrbm93IHdoZXJlIHRoZXkgYXJlIGhvc3RlZFxuXG4gICAgICAvLyBYWFg6IHRlbXBvcmFyeSBoYWNrIHRvIHdvcmsgYXJvdW5kICMxNjc0N1xuICAgICAgZHJpdmVySW5zdGFuY2Uuc2VydmVyID0gdGhpcy5zZXJ2ZXI7XG4gICAgICBkcml2ZXJJbnN0YW5jZS5zZXJ2ZXJIb3N0ID0gdGhpcy5hcmdzLmFkZHJlc3M7XG4gICAgICBkcml2ZXJJbnN0YW5jZS5zZXJ2ZXJQb3J0ID0gdGhpcy5hcmdzLnBvcnQ7XG4gICAgICBkcml2ZXJJbnN0YW5jZS5zZXJ2ZXJQYXRoID0gdGhpcy5hcmdzLmJhc2VQYXRoO1xuXG4gICAgICB0cnkge1xuICAgICAgICBydW5uaW5nRHJpdmVyc0RhdGEgPSAoYXdhaXQgdGhpcy5jdXJTZXNzaW9uRGF0YUZvckRyaXZlcihJbm5lckRyaXZlcikpID8/IFtdO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgZXJyb3JzLlNlc3Npb25Ob3RDcmVhdGVkRXJyb3IoZS5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHBlbmRpbmdEcml2ZXJzR3VhcmQuYWNxdWlyZShBcHBpdW1Ecml2ZXIubmFtZSwgKCkgPT4ge1xuICAgICAgICB0aGlzLnBlbmRpbmdEcml2ZXJzW0lubmVyRHJpdmVyLm5hbWVdID0gdGhpcy5wZW5kaW5nRHJpdmVyc1tJbm5lckRyaXZlci5uYW1lXSB8fCBbXTtcbiAgICAgICAgb3RoZXJQZW5kaW5nRHJpdmVyc0RhdGEgPSBfLmNvbXBhY3QoXG4gICAgICAgICAgdGhpcy5wZW5kaW5nRHJpdmVyc1tJbm5lckRyaXZlci5uYW1lXS5tYXAoKGRydikgPT4gZHJ2LmRyaXZlckRhdGEpXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMucGVuZGluZ0RyaXZlcnNbSW5uZXJEcml2ZXIubmFtZV0ucHVzaChkcml2ZXJJbnN0YW5jZSk7XG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgW2lubmVyU2Vzc2lvbklkLCBkQ2Fwc10gPSBhd2FpdCBkcml2ZXJJbnN0YW5jZS5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgIHByb2Nlc3NlZEpzb253cENhcGFiaWxpdGllcyxcbiAgICAgICAgICByZXFDYXBzLFxuICAgICAgICAgIHByb2Nlc3NlZFczQ0NhcGFiaWxpdGllcyxcbiAgICAgICAgICBbLi4ucnVubmluZ0RyaXZlcnNEYXRhLCAuLi5vdGhlclBlbmRpbmdEcml2ZXJzRGF0YV1cbiAgICAgICAgKTtcbiAgICAgICAgcHJvdG9jb2wgPSBkcml2ZXJJbnN0YW5jZS5wcm90b2NvbDtcbiAgICAgICAgdGhpcy5zZXNzaW9uc1tpbm5lclNlc3Npb25JZF0gPSBkcml2ZXJJbnN0YW5jZTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGF3YWl0IHBlbmRpbmdEcml2ZXJzR3VhcmQuYWNxdWlyZShBcHBpdW1Ecml2ZXIubmFtZSwgKCkgPT4ge1xuICAgICAgICAgIF8ucHVsbCh0aGlzLnBlbmRpbmdEcml2ZXJzW0lubmVyRHJpdmVyLm5hbWVdLCBkcml2ZXJJbnN0YW5jZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmF0dGFjaFVuZXhwZWN0ZWRTaHV0ZG93bkhhbmRsZXIoZHJpdmVySW5zdGFuY2UsIGlubmVyU2Vzc2lvbklkKTtcblxuICAgICAgdGhpcy5sb2cuaW5mbyhcbiAgICAgICAgYE5ldyAke0lubmVyRHJpdmVyLm5hbWV9IHNlc3Npb24gY3JlYXRlZCBzdWNjZXNzZnVsbHksIHNlc3Npb24gYCArXG4gICAgICAgICAgYCR7aW5uZXJTZXNzaW9uSWR9IGFkZGVkIHRvIG1hc3RlciBzZXNzaW9uIGxpc3RgXG4gICAgICApO1xuXG4gICAgICAvLyBzZXQgdGhlIE5ldyBDb21tYW5kIFRpbWVvdXQgZm9yIHRoZSBpbm5lciBkcml2ZXJcbiAgICAgIGRyaXZlckluc3RhbmNlLnN0YXJ0TmV3Q29tbWFuZFRpbWVvdXQoKTtcblxuICAgICAgLy8gYXBwbHkgaW5pdGlhbCB2YWx1ZXMgdG8gQXBwaXVtIHNldHRpbmdzIChpZiBwcm92aWRlZClcbiAgICAgIGlmIChkcml2ZXJJbnN0YW5jZS5pc1czQ1Byb3RvY29sKCkgJiYgIV8uaXNFbXB0eSh3M2NTZXR0aW5ncykpIHtcbiAgICAgICAgdGhpcy5sb2cuaW5mbyhcbiAgICAgICAgICBgQXBwbHlpbmcgdGhlIGluaXRpYWwgdmFsdWVzIHRvIEFwcGl1bSBzZXR0aW5ncyBwYXJzZWQgZnJvbSBXM0MgY2FwczogYCArXG4gICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh3M2NTZXR0aW5ncylcbiAgICAgICAgKTtcbiAgICAgICAgYXdhaXQgZHJpdmVySW5zdGFuY2UudXBkYXRlU2V0dGluZ3ModzNjU2V0dGluZ3MpO1xuICAgICAgfSBlbHNlIGlmIChkcml2ZXJJbnN0YW5jZS5pc01qc29ud3BQcm90b2NvbCgpICYmICFfLmlzRW1wdHkoandwU2V0dGluZ3MpKSB7XG4gICAgICAgIHRoaXMubG9nLmluZm8oXG4gICAgICAgICAgYEFwcGx5aW5nIHRoZSBpbml0aWFsIHZhbHVlcyB0byBBcHBpdW0gc2V0dGluZ3MgcGFyc2VkIGZyb20gTUpTT05XUCBjYXBzOiBgICtcbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KGp3cFNldHRpbmdzKVxuICAgICAgICApO1xuICAgICAgICBhd2FpdCBkcml2ZXJJbnN0YW5jZS51cGRhdGVTZXR0aW5ncyhqd3BTZXR0aW5ncyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHByb3RvY29sLFxuICAgICAgICBlcnJvcixcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHByb3RvY29sLFxuICAgICAgdmFsdWU6IFtpbm5lclNlc3Npb25JZCwgZENhcHMsIHByb3RvY29sXSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSB7RHJpdmVyfSBkcml2ZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGlubmVyU2Vzc2lvbklkXG4gICAqL1xuICBhdHRhY2hVbmV4cGVjdGVkU2h1dGRvd25IYW5kbGVyKGRyaXZlciwgaW5uZXJTZXNzaW9uSWQpIHtcbiAgICBjb25zdCBvblNodXRkb3duID0gKGNhdXNlID0gbmV3IEVycm9yKCdVbmtub3duIGVycm9yJykpID0+IHtcbiAgICAgIHRoaXMubG9nLndhcm4oYEVuZGluZyBzZXNzaW9uLCBjYXVzZSB3YXMgJyR7Y2F1c2UubWVzc2FnZX0nYCk7XG5cbiAgICAgIGlmICh0aGlzLnNlc3Npb25QbHVnaW5zW2lubmVyU2Vzc2lvbklkXSkge1xuICAgICAgICBmb3IgKGNvbnN0IHBsdWdpbiBvZiB0aGlzLnNlc3Npb25QbHVnaW5zW2lubmVyU2Vzc2lvbklkXSkge1xuICAgICAgICAgIGlmIChfLmlzRnVuY3Rpb24ocGx1Z2luLm9uVW5leHBlY3RlZFNodXRkb3duKSkge1xuICAgICAgICAgICAgdGhpcy5sb2cuZGVidWcoXG4gICAgICAgICAgICAgIGBQbHVnaW4gJHtwbHVnaW4ubmFtZX0gZGVmaW5lcyBhbiB1bmV4cGVjdGVkIHNodXRkb3duIGhhbmRsZXI7IGNhbGxpbmcgaXQgbm93YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHBsdWdpbi5vblVuZXhwZWN0ZWRTaHV0ZG93bihkcml2ZXIsIGNhdXNlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgdGhpcy5sb2cud2FybihcbiAgICAgICAgICAgICAgICBgR290IGFuIGVycm9yIHdoZW4gcnVubmluZyBwbHVnaW4gJHtwbHVnaW4ubmFtZX0gc2h1dGRvd24gaGFuZGxlcjogJHtlfWBcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2cuZGVidWcoYFBsdWdpbiAke3BsdWdpbi5uYW1lfSBkb2VzIG5vdCBkZWZpbmUgYW4gdW5leHBlY3RlZCBzaHV0ZG93biBoYW5kbGVyYCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMubG9nLmluZm8oYFJlbW92aW5nIHNlc3Npb24gJyR7aW5uZXJTZXNzaW9uSWR9JyBmcm9tIG91ciBtYXN0ZXIgc2Vzc2lvbiBsaXN0YCk7XG4gICAgICBkZWxldGUgdGhpcy5zZXNzaW9uc1tpbm5lclNlc3Npb25JZF07XG4gICAgICBkZWxldGUgdGhpcy5zZXNzaW9uUGx1Z2luc1tpbm5lclNlc3Npb25JZF07XG4gICAgfTtcblxuICAgIGlmIChfLmlzRnVuY3Rpb24oZHJpdmVyLm9uVW5leHBlY3RlZFNodXRkb3duKSkge1xuICAgICAgZHJpdmVyLm9uVW5leHBlY3RlZFNodXRkb3duKG9uU2h1dGRvd24pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxvZy53YXJuKFxuICAgICAgICBgRmFpbGVkIHRvIGF0dGFjaCB0aGUgdW5leHBlY3RlZCBzaHV0ZG93biBsaXN0ZW5lci4gYCArXG4gICAgICAgICAgYElzICdvblVuZXhwZWN0ZWRTaHV0ZG93bicgbWV0aG9kIGF2YWlsYWJsZSBmb3IgJyR7ZHJpdmVyLmNvbnN0cnVjdG9yLm5hbWV9Jz9gXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0ge0RyaXZlckNsYXNzfSBJbm5lckRyaXZlclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxEcml2ZXJEYXRhW10+fX1cbiAgICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLWF3YWl0XG4gIGFzeW5jIGN1clNlc3Npb25EYXRhRm9yRHJpdmVyKElubmVyRHJpdmVyKSB7XG4gICAgY29uc3QgZGF0YSA9IF8uY29tcGFjdChcbiAgICAgIF8udmFsdWVzKHRoaXMuc2Vzc2lvbnMpXG4gICAgICAgIC5maWx0ZXIoKHMpID0+IHMuY29uc3RydWN0b3IubmFtZSA9PT0gSW5uZXJEcml2ZXIubmFtZSlcbiAgICAgICAgLm1hcCgocykgPT4gcy5kcml2ZXJEYXRhKVxuICAgICk7XG4gICAgZm9yIChjb25zdCBkYXR1bSBvZiBkYXRhKSB7XG4gICAgICBpZiAoIWRhdHVtKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgUHJvYmxlbSBnZXR0aW5nIHNlc3Npb24gZGF0YSBmb3IgZHJpdmVyIHR5cGUgYCArXG4gICAgICAgICAgICBgJHtJbm5lckRyaXZlci5uYW1lfTsgZG9lcyBpdCBpbXBsZW1lbnQgJ2dldCBkcml2ZXJEYXRhJz9gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uSWRcbiAgICovXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24oc2Vzc2lvbklkKSB7XG4gICAgbGV0IHByb3RvY29sO1xuICAgIHRyeSB7XG4gICAgICBsZXQgb3RoZXJTZXNzaW9uc0RhdGE7XG4gICAgICBjb25zdCBkc3RTZXNzaW9uID0gYXdhaXQgc2Vzc2lvbnNMaXN0R3VhcmQuYWNxdWlyZShBcHBpdW1Ecml2ZXIubmFtZSwgKCkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuc2Vzc2lvbnNbc2Vzc2lvbklkXSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjdXJDb25zdHJ1Y3Rvck5hbWUgPSB0aGlzLnNlc3Npb25zW3Nlc3Npb25JZF0uY29uc3RydWN0b3IubmFtZTtcbiAgICAgICAgb3RoZXJTZXNzaW9uc0RhdGEgPSBfLnRvUGFpcnModGhpcy5zZXNzaW9ucylcbiAgICAgICAgICAuZmlsdGVyKFxuICAgICAgICAgICAgKFtrZXksIHZhbHVlXSkgPT4gdmFsdWUuY29uc3RydWN0b3IubmFtZSA9PT0gY3VyQ29uc3RydWN0b3JOYW1lICYmIGtleSAhPT0gc2Vzc2lvbklkXG4gICAgICAgICAgKVxuICAgICAgICAgIC5tYXAoKFssIHZhbHVlXSkgPT4gdmFsdWUuZHJpdmVyRGF0YSk7XG4gICAgICAgIGNvbnN0IGRzdFNlc3Npb24gPSB0aGlzLnNlc3Npb25zW3Nlc3Npb25JZF07XG4gICAgICAgIHByb3RvY29sID0gZHN0U2Vzc2lvbi5wcm90b2NvbDtcbiAgICAgICAgdGhpcy5sb2cuaW5mbyhgUmVtb3Zpbmcgc2Vzc2lvbiAke3Nlc3Npb25JZH0gZnJvbSBvdXIgbWFzdGVyIHNlc3Npb24gbGlzdGApO1xuICAgICAgICAvLyByZWdhcmRsZXNzIG9mIHdoZXRoZXIgdGhlIGRlbGV0ZVNlc3Npb24gY29tcGxldGVzIHN1Y2Nlc3NmdWxseSBvciBub3RcbiAgICAgICAgLy8gbWFrZSB0aGUgc2Vzc2lvbiB1bmF2YWlsYWJsZSwgYmVjYXVzZSB3aG8ga25vd3Mgd2hhdCBzdGF0ZSBpdCBtaWdodFxuICAgICAgICAvLyBiZSBpbiBvdGhlcndpc2VcbiAgICAgICAgZGVsZXRlIHRoaXMuc2Vzc2lvbnNbc2Vzc2lvbklkXTtcbiAgICAgICAgZGVsZXRlIHRoaXMuc2Vzc2lvblBsdWdpbnNbc2Vzc2lvbklkXTtcbiAgICAgICAgcmV0dXJuIGRzdFNlc3Npb247XG4gICAgICB9KTtcbiAgICAgIC8vIHRoaXMgbWF5IG5vdCBiZSBjb3JyZWN0LCBidXQgaWYgYGRzdFNlc3Npb25gIHdhcyBmYWxzeSwgdGhlIGNhbGwgdG8gYGRlbGV0ZVNlc3Npb24oKWAgd291bGRcbiAgICAgIC8vIHRocm93IGFueXdheS5cbiAgICAgIGlmICghZHN0U2Vzc2lvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nlc3Npb24gbm90IGZvdW5kJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwcm90b2NvbCxcbiAgICAgICAgdmFsdWU6IGF3YWl0IGRzdFNlc3Npb24uZGVsZXRlU2Vzc2lvbihzZXNzaW9uSWQsIG90aGVyU2Vzc2lvbnNEYXRhKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhpcy5sb2cuZXJyb3IoYEhhZCB0cm91YmxlIGVuZGluZyBzZXNzaW9uICR7c2Vzc2lvbklkfTogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwcm90b2NvbCxcbiAgICAgICAgZXJyb3I6IGUsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUFsbFNlc3Npb25zKG9wdHMgPSB7fSkge1xuICAgIGNvbnN0IHNlc3Npb25zQ291bnQgPSBfLnNpemUodGhpcy5zZXNzaW9ucyk7XG4gICAgaWYgKDAgPT09IHNlc3Npb25zQ291bnQpIHtcbiAgICAgIHRoaXMubG9nLmRlYnVnKCdUaGVyZSBhcmUgbm8gYWN0aXZlIHNlc3Npb25zIGZvciBjbGVhbnVwJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qge2ZvcmNlID0gZmFsc2UsIHJlYXNvbn0gPSBvcHRzO1xuICAgIHRoaXMubG9nLmRlYnVnKGBDbGVhbmluZyB1cCAke3V0aWwucGx1cmFsaXplKCdhY3RpdmUgc2Vzc2lvbicsIHNlc3Npb25zQ291bnQsIHRydWUpfWApO1xuICAgIGNvbnN0IGNsZWFudXBQcm9taXNlcyA9IGZvcmNlXG4gICAgICA/IF8udmFsdWVzKHRoaXMuc2Vzc2lvbnMpLm1hcCgoZHJ2KSA9PlxuICAgICAgICAgIGRydi5zdGFydFVuZXhwZWN0ZWRTaHV0ZG93bihyZWFzb24gJiYgbmV3IEVycm9yKHJlYXNvbikpXG4gICAgICAgIClcbiAgICAgIDogXy5rZXlzKHRoaXMuc2Vzc2lvbnMpLm1hcCgoaWQpID0+IHRoaXMuZGVsZXRlU2Vzc2lvbihpZCkpO1xuICAgIGZvciAoY29uc3QgY2xlYW51cFByb21pc2Ugb2YgY2xlYW51cFByb21pc2VzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBjbGVhbnVwUHJvbWlzZTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhpcy5sb2cuZGVidWcoZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgYXBwcm9wcmlhdGUgcGx1Z2lucyBmb3IgYSBzZXNzaW9uIChvciBzZXNzaW9ubGVzcyBwbHVnaW5zKVxuICAgKlxuICAgKiBAcGFyYW0gez9zdHJpbmd9IHNlc3Npb25JZCAtIHRoZSBzZXNzaW9uSWQgKG9yIG51bGwpIHRvIHVzZSB0byBmaW5kIHBsdWdpbnNcbiAgICogQHJldHVybnMge0FycmF5fSAtIGFycmF5IG9mIHBsdWdpbiBpbnN0YW5jZXNcbiAgICovXG4gIHBsdWdpbnNGb3JTZXNzaW9uKHNlc3Npb25JZCA9IG51bGwpIHtcbiAgICBpZiAoc2Vzc2lvbklkKSB7XG4gICAgICBpZiAoIXRoaXMuc2Vzc2lvblBsdWdpbnNbc2Vzc2lvbklkXSkge1xuICAgICAgICB0aGlzLnNlc3Npb25QbHVnaW5zW3Nlc3Npb25JZF0gPSB0aGlzLmNyZWF0ZVBsdWdpbkluc3RhbmNlcygpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuc2Vzc2lvblBsdWdpbnNbc2Vzc2lvbklkXTtcbiAgICB9XG5cbiAgICBpZiAoXy5pc0VtcHR5KHRoaXMuc2Vzc2lvbmxlc3NQbHVnaW5zKSkge1xuICAgICAgdGhpcy5zZXNzaW9ubGVzc1BsdWdpbnMgPSB0aGlzLmNyZWF0ZVBsdWdpbkluc3RhbmNlcygpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zZXNzaW9ubGVzc1BsdWdpbnM7XG4gIH1cblxuICAvKipcbiAgICogVG8gZ2V0IHBsdWdpbnMgZm9yIGEgY29tbWFuZCwgd2UgZWl0aGVyIGdldCB0aGUgcGx1Z2luIGluc3RhbmNlcyBhc3NvY2lhdGVkIHdpdGggdGhlXG4gICAqIHBhcnRpY3VsYXIgY29tbWFuZCdzIHNlc3Npb24sIG9yIGluIHRoZSBjYXNlIG9mIHNlc3Npb25sZXNzIHBsdWdpbnMsIHB1bGwgZnJvbSB0aGUgc2V0IG9mXG4gICAqIHBsdWdpbiBpbnN0YW5jZXMgcmVzZXJ2ZWQgZm9yIHNlc3Npb25sZXNzIGNvbW1hbmRzIChhbmQgd2UgbGF6aWx5IGNyZWF0ZSBwbHVnaW4gaW5zdGFuY2VzIG9uXG4gICAqIGZpcnN0IHVzZSlcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNtZCAtIHRoZSBuYW1lIG9mIHRoZSBjb21tYW5kIHRvIGZpbmQgYSBwbHVnaW4gdG8gaGFuZGxlXG4gICAqIEBwYXJhbSB7P3N0cmluZ30gc2Vzc2lvbklkIC0gdGhlIHBhcnRpY3VsYXIgc2Vzc2lvbiBmb3Igd2hpY2ggdG8gZmluZCBhIHBsdWdpbiwgb3IgbnVsbCBpZlxuICAgKiBzZXNzaW9ubGVzc1xuICAgKi9cbiAgcGx1Z2luc1RvSGFuZGxlQ21kKGNtZCwgc2Vzc2lvbklkID0gbnVsbCkge1xuICAgIC8vIHRvIGhhbmRsZSBhIGdpdmVuIGNvbW1hbmQsIGEgcGx1Z2luIHNob3VsZCBlaXRoZXIgaW1wbGVtZW50IHRoYXQgY29tbWFuZCBhcyBhIHBsdWdpblxuICAgIC8vIGluc3RhbmNlIG1ldGhvZCBvciBpdCBzaG91bGQgaW1wbGVtZW50IGEgZ2VuZXJpYyAnaGFuZGxlJyBtZXRob2RcbiAgICByZXR1cm4gdGhpcy5wbHVnaW5zRm9yU2Vzc2lvbihzZXNzaW9uSWQpLmZpbHRlcihcbiAgICAgIChwKSA9PiBfLmlzRnVuY3Rpb24ocFtjbWRdKSB8fCBfLmlzRnVuY3Rpb24ocC5oYW5kbGUpXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGluc3RhbmNlcyBvZiBhbGwgb2YgdGhlIGVuYWJsZWQgUGx1Z2luIGNsYXNzZXNcbiAgICogQHJldHVybnMge1BsdWdpbltdfVxuICAgKi9cbiAgY3JlYXRlUGx1Z2luSW5zdGFuY2VzKCkge1xuICAgIC8qKiBAdHlwZSB7UGx1Z2luW119ICovXG4gICAgY29uc3QgcGx1Z2luSW5zdGFuY2VzID0gW107XG4gICAgZm9yIChjb25zdCBbUGx1Z2luQ2xhc3MsIG5hbWVdIG9mIHRoaXMucGx1Z2luQ2xhc3Nlcy5lbnRyaWVzKCkpIHtcbiAgICAgIGNvbnN0IGNsaUFyZ3MgPSB0aGlzLmdldENsaUFyZ3NGb3JQbHVnaW4obmFtZSk7XG4gICAgICBjb25zdCBwbHVnaW4gPSBuZXcgUGx1Z2luQ2xhc3MobmFtZSwgY2xpQXJncyk7XG4gICAgICBwbHVnaW5JbnN0YW5jZXMucHVzaChwbHVnaW4pO1xuICAgIH1cbiAgICByZXR1cm4gcGx1Z2luSW5zdGFuY2VzO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjbWRcbiAgICogQHBhcmFtICB7Li4uYW55fSBhcmdzXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHt2YWx1ZTogYW55LCBlcnJvcj86IEVycm9yLCBwcm90b2NvbDogc3RyaW5nfSB8IGltcG9ydCgndHlwZS1mZXN0JykuQXN5bmNSZXR1cm5UeXBlPERyaXZlclsnZXhlY3V0ZUNvbW1hbmQnXT4+fVxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZUNvbW1hbmQoY21kLCAuLi5hcmdzKSB7XG4gICAgLy8gV2UgaGF2ZSBiYXNpY2FsbHkgdGhyZWUgY2FzZXMgZm9yIGhvdyB0byBoYW5kbGUgY29tbWFuZHM6XG4gICAgLy8gMS4gaGFuZGxlIGdldFN0YXR1cyAod2UgZG8gdGhpcyBhcyBhIHNwZWNpYWwgb3V0IG9mIGJhbmQgY2FzZSBzbyBpdCBkb2Vzbid0IGdldCBhZGRlZCB0byBhblxuICAgIC8vICAgIGV4ZWN1dGlvbiBxdWV1ZSwgYW5kIGNhbiBiZSBjYWxsZWQgd2hpbGUgZS5nLiBjcmVhdGVTZXNzaW9uIGlzIGluIHByb2dyZXNzKVxuICAgIC8vIDIuIGhhbmRsZSBjb21tYW5kcyB0aGF0IHRoaXMgdW1icmVsbGEgZHJpdmVyIHNob3VsZCBoYW5kbGUsIHJhdGhlciB0aGFuIHRoZSBhY3R1YWwgc2Vzc2lvblxuICAgIC8vICAgIGRyaXZlciAoZm9yIGV4YW1wbGUsIGRlbGV0ZVNlc3Npb24sIG9yIG90aGVyIG5vbi1zZXNzaW9uIGNvbW1hbmRzKVxuICAgIC8vIDMuIGhhbmRsZSBzZXNzaW9uIGRyaXZlciBjb21tYW5kcy5cbiAgICAvLyBUaGUgdHJpY2t5IHBhcnQgaXMgdGhhdCBiZWNhdXNlIHdlIHN1cHBvcnQgY29tbWFuZCBwbHVnaW5zLCB3ZSBuZWVkIHRvIHdyYXAgYW55IG9mIHRoZXNlXG4gICAgLy8gY2FzZXMgd2l0aCBwbHVnaW4gaGFuZGxpbmcuXG5cbiAgICBjb25zdCBpc0dldFN0YXR1cyA9IGNtZCA9PT0gR0VUX1NUQVRVU19DT01NQU5EO1xuICAgIGNvbnN0IGlzVW1icmVsbGFDbWQgPSBpc0FwcGl1bURyaXZlckNvbW1hbmQoY21kKTtcbiAgICBjb25zdCBpc1Nlc3Npb25DbWQgPSBpc1Nlc3Npb25Db21tYW5kKGNtZCk7XG5cbiAgICAvLyBpZiBhIHBsdWdpbiBvdmVycmlkZSBwcm94eWluZyBmb3IgdGhpcyBjb21tYW5kIGFuZCB0aGF0IGlzIHdoeSB3ZSBhcmUgaGVyZSBpbnN0ZWFkIG9mIGp1c3RcbiAgICAvLyBsZXR0aW5nIHRoZSBwcm90b2NvbCBwcm94eSB0aGUgY29tbWFuZCBlbnRpcmVseSwgZGV0ZXJtaW5lIHRoYXQsIGdldCB0aGUgcmVxdWVzdCBvYmplY3QgZm9yXG4gICAgLy8gdXNlIGxhdGVyIG9uLCB0aGVuIGNsZWFuIHVwIHRoZSBhcmdzXG4gICAgY29uc3QgcmVxRm9yUHJveHkgPSBfLmxhc3QoYXJncyk/LnJlcUZvclByb3h5O1xuICAgIGlmIChyZXFGb3JQcm94eSkge1xuICAgICAgYXJncy5wb3AoKTtcbiAgICB9XG5cbiAgICAvLyBmaXJzdCBkbyBzb21lIGVycm9yIGNoZWNraW5nLiBJZiB3ZSdyZSByZXF1ZXN0aW5nIGEgc2Vzc2lvbiBjb21tYW5kIGV4ZWN1dGlvbiwgdGhlbiBtYWtlXG4gICAgLy8gc3VyZSB0aGF0IHNlc3Npb24gYWN0dWFsbHkgZXhpc3RzIG9uIHRoZSBzZXNzaW9uIGRyaXZlciwgYW5kIHNldCB0aGUgc2Vzc2lvbiBkcml2ZXIgaXRzZWxmXG4gICAgbGV0IHNlc3Npb25JZCA9IG51bGw7XG4gICAgbGV0IGRzdFNlc3Npb24gPSBudWxsO1xuICAgIGxldCBwcm90b2NvbCA9IG51bGw7XG4gICAgLyoqIEB0eXBlIHt0aGlzIHwgRXh0ZXJuYWxEcml2ZXJ9ICovXG4gICAgbGV0IGRyaXZlciA9IHRoaXM7XG4gICAgaWYgKGlzU2Vzc2lvbkNtZCkge1xuICAgICAgc2Vzc2lvbklkID0gXy5sYXN0KGFyZ3MpO1xuICAgICAgZHN0U2Vzc2lvbiA9IHRoaXMuc2Vzc2lvbnNbc2Vzc2lvbklkXTtcbiAgICAgIGlmICghZHN0U2Vzc2lvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBzZXNzaW9uIHdpdGggaWQgJyR7c2Vzc2lvbklkfScgZG9lcyBub3QgZXhpc3RgKTtcbiAgICAgIH1cbiAgICAgIC8vIG5vdyBzYXZlIHRoZSByZXNwb25zZSBwcm90b2NvbCBnaXZlbiB0aGF0IHRoZSBzZXNzaW9uIGRyaXZlcidzIHByb3RvY29sIG1pZ2h0IGRpZmZlclxuICAgICAgcHJvdG9jb2wgPSBkc3RTZXNzaW9uLnByb3RvY29sO1xuICAgICAgaWYgKCFpc1VtYnJlbGxhQ21kKSB7XG4gICAgICAgIGRyaXZlciA9IGRzdFNlc3Npb247XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gZ2V0IGFueSBwbHVnaW5zIHdoaWNoIGFyZSByZWdpc3RlcmVkIGFzIGhhbmRsaW5nIHRoaXMgY29tbWFuZFxuICAgIGNvbnN0IHBsdWdpbnMgPSB0aGlzLnBsdWdpbnNUb0hhbmRsZUNtZChjbWQsIHNlc3Npb25JZCk7XG5cbiAgICAvLyBub3cgd2UgZGVmaW5lIGEgJ2NtZEhhbmRsZWRCeScgb2JqZWN0IHdoaWNoIHdpbGwga2VlcCB0cmFjayBvZiB3aGljaCBwbHVnaW5zIGhhdmUgaGFuZGxlZCB0aGlzXG4gICAgLy8gY29tbWFuZC4gd2UgY2FyZSBhYm91dCB0aGlzIGJlY2F1c2UgKGEpIG11bHRpcGxlIHBsdWdpbnMgY2FuIGhhbmRsZSB0aGUgc2FtZSBjb21tYW5kLCBhbmRcbiAgICAvLyAoYikgdGhlcmUncyBubyBndWFyYW50ZWUgdGhhdCBhIHBsdWdpbiB3aWxsIGFjdHVhbGx5IGNhbGwgdGhlIG5leHQoKSBtZXRob2Qgd2hpY2ggcnVucyB0aGVcbiAgICAvLyBvcmlnaW5hbCBjb21tYW5kIGV4ZWN1dGlvbi4gVGhpcyByZXN1bHRzIGluIGEgc2l0dWF0aW9uIHdoZXJlIHRoZSBjb21tYW5kIG1pZ2h0IGJlIGhhbmRsZWRcbiAgICAvLyBieSBzb21lIGJ1dCBub3QgYWxsIHBsdWdpbnMsIG9yIGJ5IHBsdWdpbihzKSBidXQgbm90IGJ5IHRoZSBkZWZhdWx0IGJlaGF2aW9yLiBTbyBzdGFydCBvdXRcbiAgICAvLyB0aGlzIG9iamVjdCBkZWNsYXJpbmcgdGhhdCB0aGUgZGVmYXVsdCBoYW5kbGVyIGhhcyBub3QgYmVlbiBleGVjdXRlZC5cbiAgICBjb25zdCBjbWRIYW5kbGVkQnkgPSB7ZGVmYXVsdDogZmFsc2V9O1xuXG4gICAgLy8gbm93IHdlIGRlZmluZSBhbiBhc3luYyBmdW5jdGlvbiB3aGljaCB3aWxsIGJlIHBhc3NlZCB0byBwbHVnaW5zLCBhbmQgc3VjY2Vzc2l2ZWx5IHdyYXBwZWRcbiAgICAvLyBpZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIHBsdWdpbiB0aGF0IGNhbiBoYW5kbGUgdGhlIGNvbW1hbmQuIFRvIHN0YXJ0IG9mZiB3aXRoLCB0aGUgYXN5bmNcbiAgICAvLyBmdW5jdGlvbiBpcyBkZWZpbmVkIGFzIGNhbGxpbmcgdGhlIGRlZmF1bHQgYmVoYXZpb3IsIGkuZS4sIHdoaWNoZXZlciBvZiB0aGUgMyBjYXNlcyBhYm92ZSBpc1xuICAgIC8vIHRoZSBhcHByb3ByaWF0ZSBvbmVcbiAgICBjb25zdCBkZWZhdWx0QmVoYXZpb3IgPSBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBpZiB3ZSdyZSBydW5uaW5nIHdpdGggcGx1Z2lucywgbWFrZSBzdXJlIHdlIGxvZyB0aGF0IHRoZSBkZWZhdWx0IGJlaGF2aW9yIGlzIGFjdHVhbGx5XG4gICAgICAvLyBoYXBwZW5pbmcgc28gd2UgY2FuIHRlbGwgd2hlbiB0aGUgcGx1Z2luIGNhbGwgY2hhaW4gaXMgdW53cmFwcGluZyB0byB0aGUgZGVmYXVsdCBiZWhhdmlvclxuICAgICAgLy8gaWYgdGhhdCdzIHdoYXQgaGFwcGVuc1xuICAgICAgcGx1Z2lucy5sZW5ndGggJiYgdGhpcy5sb2cuaW5mbyhgRXhlY3V0aW5nIGRlZmF1bHQgaGFuZGxpbmcgYmVoYXZpb3IgZm9yIGNvbW1hbmQgJyR7Y21kfSdgKTtcblxuICAgICAgLy8gaWYgd2UgbWFrZSBpdCBoZXJlLCB3ZSBrbm93IHRoYXQgdGhlIGRlZmF1bHQgYmVoYXZpb3IgaXMgaGFuZGxlZFxuICAgICAgY21kSGFuZGxlZEJ5LmRlZmF1bHQgPSB0cnVlO1xuXG4gICAgICBpZiAocmVxRm9yUHJveHkpIHtcbiAgICAgICAgLy8gd2Ugd291bGQgaGF2ZSBwcm94aWVkIHRoaXMgY29tbWFuZCBoYWQgYSBwbHVnaW4gbm90IGhhbmRsZWQgaXQsIHNvIHRoZSBkZWZhdWx0IGJlaGF2aW9yXG4gICAgICAgIC8vIGlzIHRvIGRvIHRoZSBwcm94eSBhbmQgcmV0cmlldmUgdGhlIHJlc3VsdCBpbnRlcm5hbGx5IHNvIGl0IGNhbiBiZSBwYXNzZWQgdG8gdGhlIHBsdWdpblxuICAgICAgICAvLyBpbiBjYXNlIGl0IGNhbGxzICdhd2FpdCBuZXh0KCknLiBUaGlzIHJlcXVpcmVzIHRoYXQgdGhlIGRyaXZlciBoYXZlIGRlZmluZWRcbiAgICAgICAgLy8gJ3Byb3h5Q29tbWFuZCcgYW5kIG5vdCBqdXN0ICdwcm94eVJlcVJlcycuXG4gICAgICAgIGlmICghZHN0U2Vzc2lvbi5wcm94eUNvbW1hbmQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgTm9Ecml2ZXJQcm94eUNvbW1hbmRFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhd2FpdCBkc3RTZXNzaW9uLnByb3h5Q29tbWFuZChcbiAgICAgICAgICByZXFGb3JQcm94eS5vcmlnaW5hbFVybCxcbiAgICAgICAgICByZXFGb3JQcm94eS5tZXRob2QsXG4gICAgICAgICAgcmVxRm9yUHJveHkuYm9keVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXNHZXRTdGF0dXMpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0U3RhdHVzKCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpc1VtYnJlbGxhQ21kKSB7XG4gICAgICAgIC8vIHNvbWUgY29tbWFuZHMsIGxpa2UgZGVsZXRlU2Vzc2lvbiwgd2Ugd2FudCB0byBtYWtlIHN1cmUgdG8gaGFuZGxlIG9uICp0aGlzKiBkcml2ZXIsXG4gICAgICAgIC8vIG5vdCB0aGUgcGxhdGZvcm0gZHJpdmVyXG4gICAgICAgIHJldHVybiBhd2FpdCBCYXNlRHJpdmVyLnByb3RvdHlwZS5leGVjdXRlQ29tbWFuZC5jYWxsKHRoaXMsIGNtZCwgLi4uYXJncyk7XG4gICAgICB9XG5cbiAgICAgIC8vIGhlcmUgd2Uga25vdyB0aGF0IHdlIGFyZSBleGVjdXRpbmcgYSBzZXNzaW9uIGNvbW1hbmQsIGFuZCBoYXZlIGEgdmFsaWQgc2Vzc2lvbiBkcml2ZXJcbiAgICAgIHJldHVybiBhd2FpdCBkc3RTZXNzaW9uLmV4ZWN1dGVDb21tYW5kKGNtZCwgLi4uYXJncyk7XG4gICAgfTtcblxuICAgIC8vIG5vdyB0YWtlIG91ciBkZWZhdWx0IGJlaGF2aW9yLCB3cmFwIGl0IHdpdGggYW55IG51bWJlciBvZiBwbHVnaW4gYmVoYXZpb3JzLCBhbmQgcnVuIGl0XG4gICAgY29uc3Qgd3JhcHBlZENtZCA9IHRoaXMud3JhcENvbW1hbmRXaXRoUGx1Z2lucyh7XG4gICAgICBkcml2ZXIsXG4gICAgICBjbWQsXG4gICAgICBhcmdzLFxuICAgICAgcGx1Z2lucyxcbiAgICAgIGNtZEhhbmRsZWRCeSxcbiAgICAgIG5leHQ6IGRlZmF1bHRCZWhhdmlvcixcbiAgICB9KTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmV4ZWN1dGVXcmFwcGVkQ29tbWFuZCh7d3JhcHBlZENtZCwgcHJvdG9jb2x9KTtcblxuICAgIC8vIGlmIHdlIGhhZCBwbHVnaW5zLCBtYWtlIHN1cmUgdG8gbG9nIG91dCB0aGUgaGVscGZ1bCByZXBvcnQgYWJvdXQgd2hpY2ggcGx1Z2lucyBlbmRlZCB1cFxuICAgIC8vIGhhbmRsaW5nIHRoZSBjb21tYW5kIGFuZCB3aGljaCBkaWRuJ3RcbiAgICB0aGlzLmxvZ1BsdWdpbkhhbmRsZXJSZXBvcnQocGx1Z2lucywge2NtZCwgY21kSGFuZGxlZEJ5fSk7XG5cbiAgICAvLyBBbmQgZmluYWxseSwgaWYgdGhlIGNvbW1hbmQgd2FzIGNyZWF0ZVNlc3Npb24sIHdlIHdhbnQgdG8gbWlncmF0ZSBhbnkgcGx1Z2lucyB3aGljaCB3ZXJlXG4gICAgLy8gcHJldmlvdXNseSBzZXNzaW9ubGVzcyB0byB1c2UgdGhlIG5ldyBzZXNzaW9uSWQsIHNvIHRoYXQgcGx1Z2lucyBjYW4gc2hhcmUgc3RhdGUgYmV0d2VlblxuICAgIC8vIHRoZWlyIGNyZWF0ZVNlc3Npb24gbWV0aG9kIGFuZCBvdGhlciBpbnN0YW5jZSBtZXRob2RzXG4gICAgaWYgKGNtZCA9PT0gQ1JFQVRFX1NFU1NJT05fQ09NTUFORCAmJiB0aGlzLnNlc3Npb25sZXNzUGx1Z2lucy5sZW5ndGggJiYgIXJlcy5lcnJvcikge1xuICAgICAgY29uc3Qgc2Vzc2lvbklkID0gXy5maXJzdChyZXMudmFsdWUpO1xuICAgICAgdGhpcy5sb2cuaW5mbyhcbiAgICAgICAgYFByb21vdGluZyAke3RoaXMuc2Vzc2lvbmxlc3NQbHVnaW5zLmxlbmd0aH0gc2Vzc2lvbmxlc3MgcGx1Z2lucyB0byBiZSBhdHRhY2hlZCBgICtcbiAgICAgICAgICBgdG8gc2Vzc2lvbiBJRCAke3Nlc3Npb25JZH1gXG4gICAgICApO1xuICAgICAgdGhpcy5zZXNzaW9uUGx1Z2luc1tzZXNzaW9uSWRdID0gdGhpcy5zZXNzaW9ubGVzc1BsdWdpbnM7XG4gICAgICB0aGlzLnNlc3Npb25sZXNzUGx1Z2lucyA9IFtdO1xuICAgIH1cblxuICAgIHJldHVybiByZXM7XG4gIH1cblxuICB3cmFwQ29tbWFuZFdpdGhQbHVnaW5zKHtkcml2ZXIsIGNtZCwgYXJncywgbmV4dCwgY21kSGFuZGxlZEJ5LCBwbHVnaW5zfSkge1xuICAgIHBsdWdpbnMubGVuZ3RoICYmXG4gICAgICB0aGlzLmxvZy5pbmZvKGBQbHVnaW5zIHdoaWNoIGNhbiBoYW5kbGUgY21kICcke2NtZH0nOiAke3BsdWdpbnMubWFwKChwKSA9PiBwLm5hbWUpfWApO1xuXG4gICAgLy8gbm93IHdlIGNhbiBnbyB0aHJvdWdoIGVhY2ggcGx1Z2luIGFuZCB3cmFwIGBuZXh0YCBhcm91bmQgaXRzIG93biBoYW5kbGVyLCBwYXNzaW5nIHRoZSAqb2xkKlxuICAgIC8vIG5leHQgaW4gc28gdGhhdCBpdCBjYW4gY2FsbCBpdCBpZiBpdCB3YW50cyB0b1xuICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIHBsdWdpbnMpIHtcbiAgICAgIC8vIG5lZWQgYW4gSUlGRSBoZXJlIGJlY2F1c2Ugd2Ugd2FudCB0aGUgdmFsdWUgb2YgbmV4dCB0aGF0J3MgcGFzc2VkIHRvIHBsdWdpbi5oYW5kbGUgdG8gYmVcbiAgICAgIC8vIGV4YWN0bHkgdGhlIHZhbHVlIG9mIG5leHQgaGVyZSBiZWZvcmUgcmVhc3NpZ25tZW50OyB3ZSBkb24ndCB3YW50IGl0IHRvIGJlIGxhemlseVxuICAgICAgLy8gZXZhbHVhdGVkLCBvdGhlcndpc2Ugd2UgZW5kIHVwIHdpdGggaW5maW5pdGUgcmVjdXJzaW9uIG9mIHRoZSBsYXN0IGBuZXh0YCB0byBiZSBkZWZpbmVkLlxuICAgICAgY21kSGFuZGxlZEJ5W3BsdWdpbi5uYW1lXSA9IGZhbHNlOyAvLyB3ZSBzZWUgYSBuZXcgcGx1Z2luLCBzbyBhZGQgaXQgdG8gdGhlICdjbWRIYW5kbGVkQnknIG9iamVjdFxuICAgICAgbmV4dCA9ICgoX25leHQpID0+IGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5sb2cuaW5mbyhgUGx1Z2luICR7cGx1Z2luLm5hbWV9IGlzIG5vdyBoYW5kbGluZyBjbWQgJyR7Y21kfSdgKTtcbiAgICAgICAgY21kSGFuZGxlZEJ5W3BsdWdpbi5uYW1lXSA9IHRydWU7IC8vIGlmIHdlIG1ha2UgaXQgaGVyZSwgdGhpcyBwbHVnaW4gaGFzIGF0dGVtcHRlZCB0byBoYW5kbGUgY21kXG4gICAgICAgIC8vIGZpcnN0IGF0dGVtcHQgdG8gaGFuZGxlIHRoZSBjb21tYW5kIHZpYSBhIGNvbW1hbmQtc3BlY2lmaWMgaGFuZGxlciBvbiB0aGUgcGx1Z2luXG4gICAgICAgIGlmIChwbHVnaW5bY21kXSkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCBwbHVnaW5bY21kXShfbmV4dCwgZHJpdmVyLCAuLi5hcmdzKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBvdGhlcndpc2UsIGNhbGwgdGhlIGdlbmVyaWMgJ2hhbmRsZScgbWV0aG9kXG4gICAgICAgIHJldHVybiBhd2FpdCBwbHVnaW4uaGFuZGxlKF9uZXh0LCBkcml2ZXIsIGNtZCwgLi4uYXJncyk7XG4gICAgICB9KShuZXh0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV4dDtcbiAgfVxuXG4gIGxvZ1BsdWdpbkhhbmRsZXJSZXBvcnQocGx1Z2lucywge2NtZCwgY21kSGFuZGxlZEJ5fSkge1xuICAgIGlmICghcGx1Z2lucy5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBhdCB0aGUgZW5kIG9mIHRoZSBkYXksIHdlIGhhdmUgYW4gb2JqZWN0IHJlcHJlc2VudGluZyB3aGljaCBwbHVnaW5zIGVuZGVkIHVwIGdldHRpbmdcbiAgICAvLyB0aGVpciBjb2RlIHJ1biBhcyBwYXJ0IG9mIGhhbmRsaW5nIHRoaXMgY29tbWFuZC4gQmVjYXVzZSBwbHVnaW5zIGNhbiBjaG9vc2UgKm5vdCogdG9cbiAgICAvLyBwYXNzIGNvbnRyb2wgdG8gb3RoZXIgcGx1Z2lucyBvciB0byB0aGUgZGVmYXVsdCBkcml2ZXIgYmVoYXZpb3IsIHRoaXMgaXMgaW5mb3JtYXRpb25cbiAgICAvLyB3aGljaCBpcyBwcm9iYWJseSB1c2VmdWwgdG8gdGhlIHVzZXIgKGVzcGVjaWFsbHkgaW4gc2l0dWF0aW9ucyB3aGVyZSBwbHVnaW5zIG1pZ2h0IG5vdFxuICAgIC8vIGludGVyYWN0IHdlbGwgdG9nZXRoZXIsIGFuZCBpdCB3b3VsZCBiZSBoYXJkIHRvIGRlYnVnIG90aGVyd2lzZSB3aXRob3V0IHRoaXMga2luZCBvZlxuICAgIC8vIG1lc3NhZ2UpLlxuICAgIGNvbnN0IGRpZEhhbmRsZSA9IE9iamVjdC5rZXlzKGNtZEhhbmRsZWRCeSkuZmlsdGVyKChrKSA9PiBjbWRIYW5kbGVkQnlba10pO1xuICAgIGNvbnN0IGRpZG50SGFuZGxlID0gT2JqZWN0LmtleXMoY21kSGFuZGxlZEJ5KS5maWx0ZXIoKGspID0+ICFjbWRIYW5kbGVkQnlba10pO1xuICAgIGlmIChkaWRudEhhbmRsZS5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmxvZy5pbmZvKFxuICAgICAgICBgQ29tbWFuZCAnJHtjbWR9JyB3YXMgKm5vdCogaGFuZGxlZCBieSB0aGUgZm9sbG93aW5nIGJlaGF2aW91cnMgb3IgcGx1Z2lucywgZXZlbiBgICtcbiAgICAgICAgICBgdGhvdWdoIHRoZXkgd2VyZSByZWdpc3RlcmVkIHRvIGhhbmRsZSBpdDogJHtKU09OLnN0cmluZ2lmeShkaWRudEhhbmRsZSl9LiBUaGUgYCArXG4gICAgICAgICAgYGNvbW1hbmQgKndhcyogaGFuZGxlZCBieSB0aGVzZTogJHtKU09OLnN0cmluZ2lmeShkaWRIYW5kbGUpfS5gXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGV4ZWN1dGVXcmFwcGVkQ29tbWFuZCh7d3JhcHBlZENtZCwgcHJvdG9jb2x9KSB7XG4gICAgbGV0IGNtZFJlcyxcbiAgICAgIGNtZEVycixcbiAgICAgIHJlcyA9IHt9O1xuICAgIHRyeSB7XG4gICAgICAvLyBBdCB0aGlzIHBvaW50LCBgd3JhcHBlZENtZGAgZGVmaW5lcyBhIHdob2xlIHNlcXVlbmNlIG9mIHBsdWdpbiBoYW5kbGVycywgY3VsbWluYXRpbmcgaW5cbiAgICAgIC8vIG91ciBkZWZhdWx0IGhhbmRsZXIuIFdoYXRldmVyIGl0IHJldHVybnMgaXMgd2hhdCB3ZSdyZSBnb2luZyB0byB3YW50IHRvIHNlbmQgYmFjayB0byB0aGVcbiAgICAgIC8vIHVzZXIuXG4gICAgICBjbWRSZXMgPSBhd2FpdCB3cmFwcGVkQ21kKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY21kRXJyID0gZTtcbiAgICB9XG5cbiAgICAvLyBTYWRseSwgd2UgZG9uJ3Qga25vdyBleGFjdGx5IHdoYXQga2luZCBvZiBvYmplY3Qgd2lsbCBiZSByZXR1cm5lZC4gSXQgd2lsbCBlaXRoZXIgYmUgYSBiYXJlXG4gICAgLy8gb2JqZWN0LCBvciBhIHByb3RvY29sLWF3YXJlIG9iamVjdCB3aXRoIHByb3RvY29sIGFuZCBlcnJvci92YWx1ZSBrZXlzLiBTbyB3ZSBuZWVkIHRvIHNuaWZmXG4gICAgLy8gaXQgYW5kIG1ha2Ugc3VyZSB3ZSBkb24ndCBkb3VibGUtd3JhcCBpdCBpZiBpdCdzIHRoZSBsYXR0ZXIga2luZC5cbiAgICBpZiAoXy5pc1BsYWluT2JqZWN0KGNtZFJlcykgJiYgXy5oYXMoY21kUmVzLCAncHJvdG9jb2wnKSkge1xuICAgICAgcmVzID0gY21kUmVzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMudmFsdWUgPSBjbWRSZXM7XG4gICAgICByZXMuZXJyb3IgPSBjbWRFcnI7XG4gICAgICByZXMucHJvdG9jb2wgPSBwcm90b2NvbDtcbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbiAgfVxuXG4gIHByb3h5QWN0aXZlKHNlc3Npb25JZCkge1xuICAgIGNvbnN0IGRzdFNlc3Npb24gPSB0aGlzLnNlc3Npb25zW3Nlc3Npb25JZF07XG4gICAgcmV0dXJuIGRzdFNlc3Npb24gJiYgXy5pc0Z1bmN0aW9uKGRzdFNlc3Npb24ucHJveHlBY3RpdmUpICYmIGRzdFNlc3Npb24ucHJveHlBY3RpdmUoc2Vzc2lvbklkKTtcbiAgfVxuXG4gIGdldFByb3h5QXZvaWRMaXN0KHNlc3Npb25JZCkge1xuICAgIGNvbnN0IGRzdFNlc3Npb24gPSB0aGlzLnNlc3Npb25zW3Nlc3Npb25JZF07XG4gICAgcmV0dXJuIGRzdFNlc3Npb24gPyBkc3RTZXNzaW9uLmdldFByb3h5QXZvaWRMaXN0KCkgOiBbXTtcbiAgfVxuXG4gIGNhblByb3h5KHNlc3Npb25JZCkge1xuICAgIGNvbnN0IGRzdFNlc3Npb24gPSB0aGlzLnNlc3Npb25zW3Nlc3Npb25JZF07XG4gICAgcmV0dXJuIGRzdFNlc3Npb24gJiYgZHN0U2Vzc2lvbi5jYW5Qcm94eShzZXNzaW9uSWQpO1xuICB9XG59XG5cbi8vIGhlbHAgZGVjaWRlIHdoaWNoIGNvbW1hbmRzIHNob3VsZCBiZSBwcm94aWVkIHRvIHN1Yi1kcml2ZXJzIGFuZCB3aGljaFxuLy8gc2hvdWxkIGJlIGhhbmRsZWQgYnkgdGhpcywgb3VyIHVtYnJlbGxhIGRyaXZlclxuZnVuY3Rpb24gaXNBcHBpdW1Ecml2ZXJDb21tYW5kKGNtZCkge1xuICByZXR1cm4gIWlzU2Vzc2lvbkNvbW1hbmQoY21kKSB8fCBjbWQgPT09IERFTEVURV9TRVNTSU9OX0NPTU1BTkQ7XG59XG5cbi8qKlxuICogVGhyb3duIHdoZW4gQXBwaXVtIHRyaWVkIHRvIHByb3h5IGEgY29tbWFuZCB1c2luZyBhIGRyaXZlcidzIGBwcm94eUNvbW1hbmRgIG1ldGhvZCBidXQgdGhlXG4gKiBtZXRob2QgZGlkIG5vdCBleGlzdFxuICovXG5leHBvcnQgY2xhc3MgTm9Ecml2ZXJQcm94eUNvbW1hbmRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgLyoqXG4gICAqIEB0eXBlIHtSZWFkb25seTxzdHJpbmc+fVxuICAgKi9cbiAgY29kZSA9ICdBUFBJVU1FUlJfTk9fRFJJVkVSX1BST1hZQ09NTUFORCc7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoXG4gICAgICBgVGhlIGRlZmF1bHQgYmVoYXZpb3IgZm9yIHRoaXMgY29tbWFuZCB3YXMgdG8gcHJveHksIGJ1dCB0aGUgZHJpdmVyIGAgK1xuICAgICAgICBgZGlkIG5vdCBoYXZlIHRoZSAncHJveHlDb21tYW5kJyBtZXRob2QgZGVmaW5lZC4gVG8gZnVsbHkgc3VwcG9ydCBgICtcbiAgICAgICAgYHBsdWdpbnMsIGRyaXZlcnMgc2hvdWxkIGhhdmUgJ3Byb3h5Q29tbWFuZCcgc2V0IHRvIGEgandwUHJveHkgb2JqZWN0J3MgYCArXG4gICAgICAgIGAnY29tbWFuZCgpJyBtZXRob2QsIGluIGFkZGl0aW9uIHRvIHRoZSBub3JtYWwgJ3Byb3h5UmVxUmVzJ2BcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCB7QXBwaXVtRHJpdmVyfTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCdAYXBwaXVtL3R5cGVzJykuRXh0ZXJuYWxEcml2ZXJ9IEV4dGVybmFsRHJpdmVyXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCdAYXBwaXVtL3R5cGVzJykuRHJpdmVyfSBEcml2ZXJcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJ0BhcHBpdW0vdHlwZXMnKS5Ecml2ZXJDbGFzc30gRHJpdmVyQ2xhc3NcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJ0BhcHBpdW0vdHlwZXMnKS5XM0NDYXBhYmlsaXRpZXN9IFczQ0NhcGFiaWxpdGllc1xuICogQHR5cGVkZWYge2ltcG9ydCgnQGFwcGl1bS90eXBlcycpLkRyaXZlckRhdGF9IERyaXZlckRhdGFcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJ0BhcHBpdW0vdHlwZXMnKS5TZXJ2ZXJBcmdzfSBEcml2ZXJPcHRzXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCdAYXBwaXVtL3R5cGVzJykuQ29uc3RyYWludHN9IENvbnN0cmFpbnRzXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCdAYXBwaXVtL3R5cGVzJykuQXBwaXVtU2VydmVyfSBBcHBpdW1TZXJ2ZXJcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJ0BhcHBpdW0vdHlwZXMnKS5FeHRlbnNpb25UeXBlfSBFeHRlbnNpb25UeXBlXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2V4dGVuc2lvbi9kcml2ZXItY29uZmlnJykuRHJpdmVyQ29uZmlnfSBEcml2ZXJDb25maWdcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJ0BhcHBpdW0vdHlwZXMnKS5QbHVnaW59IFBsdWdpblxuICogQHR5cGVkZWYge2ltcG9ydCgnQGFwcGl1bS90eXBlcycpLlBsdWdpbkNsYXNzfSBQbHVnaW5DbGFzc1xuICogQHR5cGVkZWYge2ltcG9ydCgnQGFwcGl1bS90eXBlcycpLlBsdWdpblR5cGV9IFBsdWdpblR5cGVcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJ0BhcHBpdW0vdHlwZXMnKS5Ecml2ZXJUeXBlfSBEcml2ZXJUeXBlXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCdAYXBwaXVtL3R5cGVzJykuU2Vzc2lvbkhhbmRsZXI8U2Vzc2lvbkhhbmRsZXJSZXN1bHQ8YW55W10+LFNlc3Npb25IYW5kbGVyUmVzdWx0PHZvaWQ+Pn0gU2Vzc2lvbkhhbmRsZXJcbiAqL1xuXG4vKipcbiAqIFVzZWQgYnkge0BsaW5rY29kZSBBcHBpdW1Ecml2ZXIuY3JlYXRlU2Vzc2lvbn0gYW5kIHtAbGlua2NvZGUgQXBwaXVtRHJpdmVyLmRlbGV0ZVNlc3Npb259IHRvIGRlc2NyaWJlXG4gKiByZXN1bHQuXG4gKiBAdGVtcGxhdGUgVlxuICogQHR5cGVkZWYgU2Vzc2lvbkhhbmRsZXJSZXN1bHRcbiAqIEBwcm9wZXJ0eSB7Vn0gW3ZhbHVlXVxuICogQHByb3BlcnR5IHtFcnJvcn0gW2Vycm9yXVxuICogQHByb3BlcnR5IHtzdHJpbmd9IFtwcm90b2NvbF1cbiAqL1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUNBOztBQUNBOztBQUNBOztBQVNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQU1BLE1BQU1BLDRCQUE0QixHQUFHQyxNQUFNLENBQUNDLE1BQVAsQ0FBYztFQUNqREMsY0FBYyxFQUFFO0lBQ2RDLFFBQVEsRUFBRSxJQURJO0lBRWRDLFFBQVEsRUFBRTtFQUZJLENBRGlDO0VBS2pEQyxZQUFZLEVBQUU7SUFDWkYsUUFBUSxFQUFFLElBREU7SUFFWkMsUUFBUSxFQUFFO0VBRkU7QUFMbUMsQ0FBZCxDQUFyQztBQVdB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